import{u as Q,j as e,b as te,p as ae,_ as f,s as ne,d as ie,q as le,r as Y,v as oe,t as r,o as ce}from"../main.DB7J0o3m.1748844899215.js";import{c as u,d as M,s as A,L as O,F as T,R,C as i,f as de,I as he,Q as B,w as z,B as y,ai as S,x as me,m as $,q as pe,aj as xe,ak as ue,e as je,i as w,j as ge,k as _e,h as fe,T as ye,o as we,n as be}from"./antd.tbETyFFE.1748844899215.js";import{i as Re,r as U,L as Ce}from"./vendor.B47oQPyY.1748844899215.js";import{h as ke,u as qe}from"./useReCaptcha.DL7F4TyT.1748844899215.js";import"./toast.C9WEee-3.1748844899215.js";const{Content:Ie}=O,{Text:D,Title:V}=ye,L=ce(),J="YYYY-MM-DD",Pe=()=>{const{getBasicSettings:C}=Q(),b=C(),j=b==null?void 0:b.captcha;return j.status?e.jsxs(e.Fragment,{children:[j!=null&&j.hide_badge?e.jsx("style",{children:".grecaptcha-badge {visibility: hidden !important;}"}):null,e.jsx(ke,{reCaptchaKey:j.site_key,scriptProps:{async:!1,defer:!1,appendTo:"head",nonce:void 0},children:e.jsx(K,{})})]}):e.jsx(K,{})};function K(){var W;const C=te(),b=Re(),[j]=u.useForm(),{getBasicSettings:X}=Q(),{handleReCaptchaVerify:Z}=qe(),[v,E]=U.useState(""),[ee,k]=ae(),a=X(),P=(a==null?void 0:a.login_with_google_url)||"",N=(a==null?void 0:a.login_with_envato_url)||"",I=(a==null?void 0:a.disable_registration_form)!=="Y"&&(a==null?void 0:a.disable_guest_ticket_creation)!=="Y",G=a==null?void 0:a.captcha,q=((W=a==null?void 0:a.custom_fields)==null?void 0:W.reg_form)||[],H={};for(const s of q){const t=(s==null?void 0:s.field_type)||"",d=(s==null?void 0:s.input_name)||"",n=(s==null?void 0:s.field_value)||"";if(t==="E")continue;let p=n;t==="N"?p=n?f.toNumber(n):"":t==="D"?p=n?M(n):"":t==="S"?p=n?!!n:!1:p=f.trim(n),H[d]=p}const se={...H,email:"",first_name:"",last_name:"",password:"",password2:""},re=async s=>{var g,F,x;const t=((g=s==null?void 0:s.email)==null?void 0:g.trim())||"",d=((F=s==null?void 0:s.first_name)==null?void 0:F.trim())||"",n=((x=s==null?void 0:s.last_name)==null?void 0:x.trim())||"",p=(s==null?void 0:s.password)||"";let h="";if(G.status&&G.on_reg_form&&(h=await Z(),!h)){A.error(r("reCAPTCHA verification failed"));return}const m={};for(const l in s){const o=q.find(_=>(_==null?void 0:_.input_name)===l);if(o&&(f.has(o,"is_editable")?(o==null?void 0:o.is_editable)||!1:!0)){const c=(o==null?void 0:o.field_type)||"";c==="N"?m[l]=f.toString(s[l]):c==="D"?m[l]=M(s[l]).format(J):c==="S"?m[l]=s[l]?1:0:m[l]=f.trim(s[l])}}ee({params:{action:"users_register"},data:{grcToken:h,email:t,first_name:d,last_name:n,password:p,custom_fields:JSON.stringify(m)}})};return U.useEffect(()=>{var p,h,m,g;const{data:s,isLoading:t,isError:d,error:n}=k;C(t?ne():ie()),!t&&d&&((h=(p=n==null?void 0:n.data)==null?void 0:p.errors)!=null&&h.message)&&A.error((g=(m=n==null?void 0:n.data)==null?void 0:m.errors)==null?void 0:g.message),!t&&!d&&s&&(s!=null&&s.msg&&(s!=null&&s.status?(E(""),A.success(s==null?void 0:s.msg)):(E(s==null?void 0:s.msg),le())),s!=null&&s.status&&b("/login"))},[k,b,C]),e.jsx(O,{style:{background:"transparent",minHeight:L?"auto":"calc(100vh - 48px)",padding:"8px 0"},children:e.jsx(Ie,{style:{padding:"0 8px"},children:e.jsx(T,{vertical:!0,justify:"center",align:"center",style:{minHeight:L?"auto":"calc(100vh - 64px)"},children:e.jsx(R,{justify:"space-around",style:{width:"100%"},children:e.jsx(i,{span:24,style:{maxWidth:"620px"},children:e.jsx(R,{children:e.jsx(i,{span:24,children:e.jsxs(de,{size:"small",styles:{header:{background:"#fafafa"},body:{padding:"24px"}},style:{width:"100%"},children:[e.jsxs(R,{children:[L?null:e.jsx(i,{span:24,style:{textAlign:"center",marginBottom:"24px"},children:e.jsx("a",{href:Y(),style:{display:"inline-block",lineHeight:0},children:e.jsx(he,{src:oe(),preview:!1,width:"auto",height:34})})}),e.jsxs(i,{span:24,children:[L?null:e.jsx(B,{style:{margin:"0 0 12px 0"}}),e.jsxs(R,{gutter:16,justify:"space-between",align:"middle",style:{marginBottom:"4px"},children:[e.jsx(i,{style:{paddingBottom:"8px"},children:I?e.jsx(e.Fragment,{children:e.jsxs(T,{gap:"0 8px",wrap:!0,children:[e.jsx(z,{title:r("Home"),children:e.jsx(y,{href:Y(),icon:e.jsx(S,{})})}),e.jsx(y,{href:"#/login",icon:e.jsx(me,{}),children:"Login"})]})}):e.jsx(V,{level:5,style:{fontSize:"16px",margin:0},children:r("Register")})}),e.jsx(i,{style:{paddingBottom:"8px"},children:e.jsxs($,{children:[(a==null?void 0:a.disable_guest_ticket_creation)!=="Y"?e.jsx(y,{color:"primary",variant:"outlined",href:"#/create",icon:e.jsx(pe,{}),children:r("Create Ticket as a Guest")}):null,I?null:e.jsx(z,{title:r("Home"),children:e.jsx(y,{href:Y(),icon:e.jsx(S,{})})})]})})]}),e.jsx(B,{style:{margin:"0 0 24px 0"}})]})]}),e.jsxs(R,{children:[I?e.jsx(i,{span:24,children:e.jsx(V,{level:5,style:{fontSize:"16px",margin:"0 0 24px 0"},children:r("Register")})}):null,P||N?e.jsxs(e.Fragment,{children:[P?e.jsx(i,{span:24,children:e.jsx(y,{href:P,icon:e.jsx(xe,{}),size:"large",variant:"filled",style:{width:"100%",background:"#1a73e8",borderColor:"#1a73e8",color:"#ffffff",marginBottom:"12px"},children:r("Register with Google")})}):null,N?e.jsx(i,{span:24,children:e.jsx(y,{href:N,icon:e.jsx(ue,{}),size:"large",variant:"filled",style:{width:"100%",background:"#82b440",borderColor:"#82b440",color:"#ffffff",marginBottom:"12px"},children:r("Register with Envato")})}):null,e.jsx(i,{span:24,children:e.jsx(B,{style:{margin:"12px 0 24px 0"},plain:!0,children:e.jsx(D,{children:r("or")})})})]}):null,e.jsxs(i,{span:24,children:[e.jsx(u,{form:j,name:"register",layout:"vertical",onFinish:re,initialValues:se,autoComplete:"off",children:e.jsxs(R,{gutter:16,children:[v?e.jsx(i,{span:24,children:e.jsx(je,{message:v,type:"error",showIcon:!0,closable:!0,afterClose:()=>E(""),style:{marginBottom:"24px"}})}):null,e.jsx(i,{span:12,children:e.jsx(u.Item,{label:r("First Name"),name:"first_name",rules:[{required:!0,message:r("%s is required.",r("First name")),whitespace:!0}],children:e.jsx(w,{})})}),e.jsx(i,{span:12,children:e.jsx(u.Item,{label:r("Last Name"),name:"last_name",rules:[{required:!0,message:r("%s is required.",r("Last name")),whitespace:!0}],children:e.jsx(w,{})})}),e.jsx(i,{span:24,children:e.jsx(u.Item,{label:r("Email Address"),name:"email",rules:[{required:!0,message:r("%s is required.",r("Email address")),whitespace:!0}],children:e.jsx(w,{})})}),e.jsx(i,{span:24,children:e.jsx(u.Item,{label:r("Password"),name:"password",rules:[{required:!0,message:r("%s is required.",r("Password"))}],children:e.jsx(w.Password,{})})}),e.jsx(i,{span:24,children:e.jsx(u.Item,{label:r("Confirm Password"),name:"password2",dependencies:["password"],rules:[{required:!0,message:r("%s is required.",r("Confirm password"))},({getFieldValue:s})=>({validator(t,d){return!d||s("password")===d?Promise.resolve():Promise.reject(new Error(r("Password do not match!")))}})],children:e.jsx(w.Password,{})})}),q==null?void 0:q.map(s=>{const t=(s==null?void 0:s.field_type)||"",d=(s==null?void 0:s.input_name)||"",n=(s==null?void 0:s.field_label)||"",p=(s==null?void 0:s.field_value)||"",h=(s==null?void 0:s.fld_option)||"",m=(s==null?void 0:s.help_text)||"",g=(s==null?void 0:s.is_required)==="Y",F=(s==null?void 0:s.is_half_field)==="Y",x=f.has(s,"is_editable")?(s==null?void 0:s.is_editable)||!1:!0;let l=[];d==="wc_store_id"?l=h==null?void 0:h.map(c=>({value:f.toString(c==null?void 0:c.id),label:c==null?void 0:c.title})):l=h?h.split(",").map(c=>({value:c,label:c})):[],t==="W"&&!l.find(c=>(c==null?void 0:c.value)===p)&&(l=[{value:"",label:`-- ${r("Select")} ---`},...l]);let o=null;t==="T"?o=e.jsx(w,{placeholder:m,disabled:!x}):t==="N"?o=e.jsx(we,{placeholder:m,disabled:!x,style:{width:"100%"}}):t==="D"?o=e.jsx(ge,{placeholder:m||r("Select date"),format:J,disabled:!x,style:{width:"100%"}}):t==="S"?o=e.jsx(be,{disabled:!x}):t==="R"?o=e.jsx(_e.Group,{options:l,disabled:!x}):t==="W"?o=e.jsx(fe,{placeholder:m||r("Select option"),options:l,disabled:!x,style:{width:"100%"}}):t==="U"&&(o=e.jsx(w,{disabled:!x}));const _={};return t==="R"&&(_.htmlFor=null),e.jsx(i,{span:F?12:24,children:t==="E"?e.jsx(D,{style:{display:"block",marginBottom:"24px"},children:h}):e.jsx(u.Item,{label:n,name:d,rules:[{required:!!(x&&g),message:r("This field is required.")}],..._,children:o})},d)}),e.jsx(i,{span:24,style:{textAlign:"right"},children:e.jsx($,{children:e.jsx(y,{type:"primary",htmlType:"submit",loading:k==null?void 0:k.isLoading,children:r("Register")})})})]})}),I?null:e.jsxs(e.Fragment,{children:[e.jsx(B,{style:{margin:"24px 0"}}),e.jsxs(T,{gap:"0 8px",align:"center",justify:"center",wrap:!0,children:[e.jsx(D,{children:r("Already have an account?")}),e.jsx(T,{gap:"0 8px",align:"center",wrap:!0,children:e.jsx(Ce,{to:"/login",children:r("Login")})})]})]})]})]})]})})})})})})})})}export{Pe as default};
