import{b as U,u as z,p as D,s as G,d as W,q as L,j as s,r as S,v as $,t as a,o as Q}from"../main.DB7J0o3m.1748844899215.js";import{i as V,r as j}from"./vendor.B47oQPyY.1748844899215.js";import"./toast.C9WEee-3.1748844899215.js";import{c as d,s as X,L as k,F as T,R as i,C as r,f as q,I as J,Q as F,w as K,B as c,ai as Y,x as Z,X as O,g as u,A as ss,e as M,i as w,m as es,T as rs}from"./antd.tbETyFFE.1748844899215.js";const{Content:as}=k,{Title:ns}=rs,p=Q();function ds(){const x=U(),E=V(),[f]=d.useForm(),{getBasicSettings:R}=z(),[y,h]=j.useState(""),[_,g]=j.useState(""),[v,l]=D(),m=R(),A=(m==null?void 0:m.logged_user)||{},H={old_password:"",new_password:"",new_password2:""},N=e=>{const o=(e==null?void 0:e.old_password)||"",n=(e==null?void 0:e.new_password)||"";v({params:{action:"users_change_password"},data:{old_password:o,new_password:n}})};return j.useEffect(()=>{var b,C,I,P,B;const{data:e,isLoading:o,isError:n,error:t}=l;x(o?G():W()),!o&&n&&((C=(b=t==null?void 0:t.data)==null?void 0:b.errors)!=null&&C.message)&&X.error((P=(I=t==null?void 0:t.data)==null?void 0:I.errors)==null?void 0:P.message),!o&&!n&&e&&(e!=null&&e.msg&&(e!=null&&e.status?(h(""),g(e==null?void 0:e.msg),L()):(h(e==null?void 0:e.msg),g(""),L())),e!=null&&e.status&&((B=window==null?void 0:window.location)==null||B.reload()))},[l,E,x,f]),s.jsx(k,{style:{background:"transparent",minHeight:p?"auto":"calc(100vh - 48px)",padding:"8px 0"},children:s.jsx(as,{style:{padding:"0 8px"},children:s.jsx(T,{vertical:!0,justify:"center",align:"center",style:{minHeight:p?"auto":"calc(100vh - 64px)"},children:s.jsx(i,{justify:"space-around",style:{width:"100%"},children:s.jsx(r,{span:24,style:{maxWidth:"620px"},children:s.jsx(i,{children:s.jsx(r,{span:24,children:s.jsxs(q,{size:"small",styles:{header:{background:"#fafafa"},body:{padding:"24px"}},style:{width:"100%"},children:[s.jsxs(i,{children:[p?null:s.jsx(r,{span:24,style:{textAlign:"center",marginBottom:"24px"},children:s.jsx("a",{href:S(),style:{display:"inline-block",lineHeight:0},children:s.jsx(J,{src:$(),preview:!1,width:"auto",height:34})})}),s.jsxs(r,{span:24,children:[p?null:s.jsx(F,{style:{margin:"0 0 12px 0"}}),s.jsxs(i,{gutter:16,justify:"space-between",align:"middle",style:{marginBottom:"4px"},children:[s.jsx(r,{style:{paddingBottom:"8px"},children:s.jsxs(T,{gap:"0 8px",wrap:!0,children:[s.jsx(K,{title:a("Home"),children:s.jsx(c,{href:S(),icon:s.jsx(Y,{})})}),s.jsx(c,{href:"#/profile",icon:s.jsx(Z,{}),children:"Profile"})]})}),s.jsx(r,{style:{paddingBottom:"8px"},children:s.jsx(c,{color:"primary",variant:"outlined",href:"#/",icon:s.jsx(O,{}),children:a("Back to Tickets")})})]}),s.jsx(F,{style:{margin:"0 0 24px 0"}})]})]}),s.jsxs(i,{children:[s.jsx(r,{span:24,children:s.jsx(ns,{level:5,style:{fontSize:"16px",margin:"0 0 12px 0"},children:a("Change Password")})}),s.jsx(r,{span:24,children:s.jsx(q,{size:"small",styles:{body:{padding:0}},style:{borderColor:"#d9d9d9",marginBottom:"24px"},children:s.jsx(u,{itemLayout:"horizontal",dataSource:[A],renderItem:e=>s.jsx(u.Item,{style:{padding:"8px",margin:0},children:s.jsx(u.Item.Meta,{avatar:s.jsx(ss,{src:(e==null?void 0:e.img)||""}),title:e==null?void 0:e.name,description:e==null?void 0:e.email})}),className:"sg-ticket-users-list"})})}),s.jsx(r,{span:24,children:s.jsx(d,{form:f,name:"changePassword",layout:"vertical",onFinish:N,initialValues:H,autoComplete:"off",children:s.jsxs(i,{gutter:16,children:[y?s.jsx(r,{span:24,children:s.jsx(M,{message:y,type:"error",showIcon:!0,closable:!0,afterClose:()=>h(""),style:{marginBottom:"24px"}})}):null,_?s.jsx(r,{span:24,children:s.jsx(M,{message:_,type:"success",showIcon:!1,closable:!0,afterClose:()=>g(""),style:{marginBottom:"24px"}})}):null,s.jsx(r,{span:24,children:s.jsx(d.Item,{label:a("Current Password"),name:"old_password",rules:[{required:!0,message:a("%s is required.",a("Current password"))}],children:s.jsx(w.Password,{})})}),s.jsx(r,{span:24,children:s.jsx(d.Item,{label:a("New Password"),name:"new_password",rules:[{required:!0,message:a("%s is required.",a("New password"))}],children:s.jsx(w.Password,{})})}),s.jsx(r,{span:24,children:s.jsx(d.Item,{label:a("Confirm New Password"),name:"new_password2",dependencies:["new_password"],rules:[{required:!0,message:a("%s is required.",a("Confirm new password"))},({getFieldValue:e})=>({validator(o,n){return!n||e("new_password")===n?Promise.resolve():Promise.reject(new Error(a("Password do not match!")))}})],children:s.jsx(w.Password,{})})}),s.jsx(r,{span:24,style:{textAlign:"right"},children:s.jsx(es,{children:s.jsx(c,{type:"primary",htmlType:"submit",loading:l==null?void 0:l.isLoading,children:a("Update")})})})]})})})]})]})})})})})})})})}export{ds as default};
