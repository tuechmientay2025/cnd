import{u as W,j as e,b as V,p as K,s as Q,d as J,q as X,r as C,v as Z,t as n,o as O}from"../main.DB7J0o3m.1748844899215.js";import{r as F,L as E}from"./vendor.B47oQPyY.1748844899215.js";import{h as S,u as ee}from"./useReCaptcha.DL7F4TyT.1748844899215.js";import"./toast.C9WEee-3.1748844899215.js";import{c as m,s as P,L as M,F as f,R as l,C as t,f as se,I as re,Q as u,w as H,B as c,ai as q,ad as ne,m as A,q as te,aj as ie,ak as ae,e as oe,i as G,p as le,T as ce}from"./antd.tbETyFFE.1748844899215.js";const{Content:de}=M,{Text:v,Title:z}=ce,y=O(),ge=()=>{const{getBasicSettings:w}=W(),a=w(),o=a==null?void 0:a.captcha;return o.status?e.jsxs(e.Fragment,{children:[o!=null&&o.hide_badge?e.jsx("style",{children:".grecaptcha-badge {visibility: hidden !important;}"}):null,e.jsx(S,{reCaptchaKey:o.site_key,scriptProps:{async:!1,defer:!1,appendTo:"head",nonce:void 0},children:e.jsx(U,{})})]}):e.jsx(U,{})};function U(){const w={username:"",password:"",remember:!1},a=V(),[o]=m.useForm(),{getBasicSettings:Y}=W(),{handleReCaptchaVerify:$}=ee(),[R,_]=F.useState(""),[D,h]=K(),r=Y(),L=(r==null?void 0:r.login_with_google_url)||"",b=(r==null?void 0:r.login_with_envato_url)||"",j=(r==null?void 0:r.disable_registration_form)!=="Y"&&(r==null?void 0:r.disable_guest_ticket_creation)!=="Y",k=r==null?void 0:r.captcha,N=async s=>{var p;const x=((p=s==null?void 0:s.username)==null?void 0:p.trim())||"",g=(s==null?void 0:s.password)||"",i=(s==null?void 0:s.remember)||!1;let d="";if(k.status&&k.on_login_form&&(d=await $(),!d)){P.error(n("reCAPTCHA verification failed"));return}D({params:{action:"users_login"},data:{grcToken:d,username:x,password:g,remember:i}})};return F.useEffect(()=>{var d,p,B,I,T;const{data:s,isLoading:x,isError:g,error:i}=h;a(x?Q():J()),!x&&g&&((p=(d=i==null?void 0:i.data)==null?void 0:d.errors)!=null&&p.message)&&P.error((I=(B=i==null?void 0:i.data)==null?void 0:B.errors)==null?void 0:I.message),!x&&!g&&s&&(s!=null&&s.msg&&(s!=null&&s.status?_(""):(_(s==null?void 0:s.msg),X())),s!=null&&s.status&&((T=window==null?void 0:window.location)==null||T.reload()))},[h,a]),e.jsx(M,{style:{background:"transparent",minHeight:y?"auto":"calc(100vh - 48px)",padding:"8px 0"},children:e.jsx(de,{style:{padding:"0 8px"},children:e.jsx(f,{vertical:!0,justify:"center",align:"center",style:{minHeight:y?"auto":"calc(100vh - 64px)"},children:e.jsx(l,{justify:"space-around",style:{width:"100%"},children:e.jsx(t,{span:24,style:{maxWidth:"620px"},children:e.jsx(l,{children:e.jsx(t,{span:24,children:e.jsxs(se,{size:"small",styles:{header:{background:"#fafafa"},body:{padding:"24px"}},style:{width:"100%"},children:[e.jsxs(l,{children:[y?null:e.jsx(t,{span:24,style:{textAlign:"center",marginBottom:"24px"},children:e.jsx("a",{href:C(),style:{display:"inline-block",lineHeight:0},children:e.jsx(re,{src:Z(),preview:!1,width:"auto",height:34})})}),e.jsxs(t,{span:24,children:[y?null:e.jsx(u,{style:{margin:"0 0 12px 0"}}),e.jsxs(l,{gutter:16,justify:"space-between",align:"middle",style:{marginBottom:"4px"},children:[e.jsx(t,{style:{paddingBottom:"8px"},children:j?e.jsx(e.Fragment,{children:e.jsxs(f,{gap:"0 8px",wrap:!0,children:[e.jsx(H,{title:n("Home"),children:e.jsx(c,{href:C(),icon:e.jsx(q,{})})}),e.jsx(c,{href:"#/register",icon:e.jsx(ne,{}),children:"Register"})]})}):e.jsx(z,{level:5,style:{fontSize:"16px",margin:0},children:n("Login")})}),e.jsx(t,{style:{paddingBottom:"8px"},children:e.jsxs(A,{children:[(r==null?void 0:r.disable_guest_ticket_creation)!=="Y"?e.jsx(c,{color:"primary",variant:"outlined",href:"#/create",icon:e.jsx(te,{}),children:n("Create Ticket as a Guest")}):null,j?null:e.jsx(H,{title:n("Home"),children:e.jsx(c,{href:C(),icon:e.jsx(q,{})})})]})})]}),e.jsx(u,{style:{margin:"0 0 24px 0"}})]})]}),e.jsxs(l,{children:[j?e.jsx(t,{span:24,children:e.jsx(z,{level:5,style:{fontSize:"16px",margin:"0 0 24px 0"},children:n("Login")})}):null,L||b?e.jsxs(e.Fragment,{children:[L?e.jsx(t,{span:24,children:e.jsx(c,{href:L,icon:e.jsx(ie,{}),size:"large",variant:"filled",style:{width:"100%",background:"#1a73e8",borderColor:"#1a73e8",color:"#ffffff",marginBottom:"12px"},children:n("Login with Google")})}):null,b?e.jsx(t,{span:24,children:e.jsx(c,{href:b,icon:e.jsx(ae,{}),size:"large",variant:"filled",style:{width:"100%",background:"#82b440",borderColor:"#82b440",color:"#ffffff",marginBottom:"12px"},children:n("Login with Envato")})}):null,e.jsx(t,{span:24,children:e.jsx(u,{style:{margin:"12px 0 24px 0"},plain:!0,children:e.jsx(v,{children:n("or")})})})]}):null,e.jsxs(t,{span:24,children:[e.jsx(m,{form:o,name:"login",layout:"vertical",onFinish:N,initialValues:w,autoComplete:"off",children:e.jsxs(l,{gutter:16,children:[R?e.jsx(t,{span:24,children:e.jsx(oe,{message:R,type:"error",showIcon:!0,closable:!0,afterClose:()=>_(""),style:{marginBottom:"24px"}})}):null,e.jsx(t,{span:24,children:e.jsx(m.Item,{label:n("Username or Email Address"),name:"username",rules:[{required:!0,message:n("%s is required.",n("Username or email address")),whitespace:!0}],children:e.jsx(G,{})})}),e.jsx(t,{span:24,children:e.jsx(m.Item,{label:n("Password"),name:"password",rules:[{required:!0,message:n("%s is required.",n("Password"))}],children:e.jsx(G.Password,{})})}),e.jsx(t,{span:24,children:e.jsxs(l,{gutter:16,children:[e.jsx(t,{flex:"auto",children:e.jsx(m.Item,{name:"remember",valuePropName:"checked",children:e.jsx(le,{children:n("Remember me.")})})}),e.jsx(t,{flex:"none",children:e.jsx(A,{style:{marginBottom:"24px"},children:e.jsx(c,{type:"primary",htmlType:"submit",loading:h==null?void 0:h.isLoading,children:n("Login")})})})]})})]})}),e.jsx(u,{style:{margin:"0 0 24px 0"}}),e.jsxs(f,{gap:"0 8px",align:"center",justify:"center",wrap:!0,children:[e.jsx(v,{children:n("Lost your password?")}),e.jsxs(f,{gap:"0 8px",align:"center",wrap:!0,children:[e.jsx(E,{className:"sg-anchor",to:"/reset-password",children:n("Reset Password")}),(r==null?void 0:r.disable_registration_form)!=="Y"&&!j?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"|"}),e.jsx(E,{to:"/register",children:n("Register")})]}):null]})]})]})]})]})})})})})})})})}export{ge as default};
