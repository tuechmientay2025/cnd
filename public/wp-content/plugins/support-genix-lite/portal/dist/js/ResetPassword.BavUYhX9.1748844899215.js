import{u as Y,j as e,b as W,p as V,s as $,d as K,q as v,r as f,v as Q,t as r,o as J}from"../main.DB7J0o3m.1748844899215.js";import{r as y,L as X}from"./vendor.B47oQPyY.1748844899215.js";import{h as Z,u as O}from"./useReCaptcha.DL7F4TyT.1748844899215.js";import"./toast.C9WEee-3.1748844899215.js";import{c as w,s as I,L as q,F as p,R as c,C as a,f as S,I as ee,Q as _,w as P,B as d,ai as b,x as H,m as A,q as se,e as E,i as te,T as re}from"./antd.tbETyFFE.1748844899215.js";const{Content:ae}=q,{Text:ne,Title:M}=re,m=J(),xe=()=>{const{getBasicSettings:u}=Y(),o=u(),n=o==null?void 0:o.captcha;return n.status?e.jsxs(e.Fragment,{children:[n!=null&&n.hide_badge?e.jsx("style",{children:".grecaptcha-badge {visibility: hidden !important;}"}):null,e.jsx(Z,{reCaptchaKey:n.site_key,scriptProps:{async:!1,defer:!1,appendTo:"head",nonce:void 0},children:e.jsx(U,{})})]}):e.jsx(U,{})};function U(){const u={username:""},o=W(),[n]=w.useForm(),{getBasicSettings:G}=Y(),{handleReCaptchaVerify:z}=O(),[C,j]=y.useState(""),[R,g]=y.useState(""),[D,x]=V(),t=G(),T=t==null?void 0:t.captcha,N=async s=>{var i;const h=((i=s==null?void 0:s.username)==null?void 0:i.trim())||"";let l="";if(T.status&&T.on_login_form&&(l=await z(),!l)){I.error(r("reCAPTCHA verification failed"));return}D({params:{action:"users_reset_password"},data:{grcToken:l,username:h}})};return y.useEffect(()=>{var k,B,F,L;const{data:s,isLoading:h,isError:l,error:i}=x;o(h?$():K()),!h&&l&&((B=(k=i==null?void 0:i.data)==null?void 0:k.errors)!=null&&B.message)&&I.error((L=(F=i==null?void 0:i.data)==null?void 0:F.errors)==null?void 0:L.message),!h&&!l&&s&&(s!=null&&s.msg&&(s!=null&&s.status?(j(""),g(s==null?void 0:s.msg),v()):(j(s==null?void 0:s.msg),g(""),v())),s!=null&&s.status&&n.resetFields())},[x,o,n]),e.jsx(q,{style:{background:"transparent",minHeight:m?"auto":"calc(100vh - 48px)",padding:"8px 0"},children:e.jsx(ae,{style:{padding:"0 8px"},children:e.jsx(p,{vertical:!0,justify:"center",align:"center",style:{minHeight:m?"auto":"calc(100vh - 64px)"},children:e.jsx(c,{justify:"space-around",style:{width:"100%"},children:e.jsx(a,{span:24,style:{maxWidth:"620px"},children:e.jsx(c,{children:e.jsx(a,{span:24,children:e.jsxs(S,{size:"small",styles:{header:{background:"#fafafa"},body:{padding:"24px"}},style:{width:"100%"},children:[e.jsxs(c,{children:[m?null:e.jsx(a,{span:24,style:{textAlign:"center",marginBottom:"24px"},children:e.jsx("a",{href:f(),style:{display:"inline-block",lineHeight:0},children:e.jsx(ee,{src:Q(),preview:!1,width:"auto",height:34})})}),e.jsxs(a,{span:24,children:[m?null:e.jsx(_,{style:{margin:"0 0 12px 0"}}),e.jsxs(c,{gutter:16,justify:"space-between",align:"middle",style:{marginBottom:"4px"},children:[e.jsx(a,{style:{paddingBottom:"8px"},children:(t==null?void 0:t.disable_guest_ticket_creation)!=="Y"?e.jsx(e.Fragment,{children:e.jsxs(p,{gap:"0 8px",wrap:!0,children:[e.jsx(P,{title:r("Home"),children:e.jsx(d,{href:f(),icon:e.jsx(b,{})})}),e.jsx(d,{href:"#/login",icon:e.jsx(H,{}),children:"Login"})]})}):e.jsx(M,{level:5,style:{fontSize:"16px",margin:0},children:r("Reset Password")})}),e.jsx(a,{style:{paddingBottom:"8px"},children:e.jsxs(A,{children:[(t==null?void 0:t.disable_guest_ticket_creation)!=="Y"?e.jsx(d,{color:"primary",variant:"outlined",href:"#/create",icon:e.jsx(se,{}),children:r("Create Ticket as a Guest")}):e.jsx(d,{href:"#/login",icon:e.jsx(H,{}),children:"Login"}),(t==null?void 0:t.disable_guest_ticket_creation)==="Y"?e.jsx(P,{title:r("Home"),children:e.jsx(d,{href:f(),icon:e.jsx(b,{})})}):null]})})]}),e.jsx(_,{style:{margin:"0 0 24px 0"}})]})]}),e.jsxs(c,{children:[(t==null?void 0:t.disable_guest_ticket_creation)!=="Y"?e.jsx(a,{span:24,children:e.jsx(M,{level:5,style:{fontSize:"16px",margin:"0 0 24px 0"},children:r("Reset Password")})}):null,e.jsxs(a,{span:24,children:[e.jsx(w,{form:n,name:"resetPassword",layout:"vertical",onFinish:N,initialValues:u,autoComplete:"off",children:e.jsxs(c,{gutter:16,children:[C?e.jsx(a,{span:24,children:e.jsx(E,{message:C,type:"error",showIcon:!0,closable:!0,afterClose:()=>j(""),style:{marginBottom:"24px"}})}):null,R?e.jsx(a,{span:24,children:e.jsx(E,{message:R,type:"success",showIcon:!1,closable:!0,afterClose:()=>g(""),style:{marginBottom:"24px"}})}):null,e.jsx(a,{span:24,children:e.jsx(w.Item,{label:r("Username or Email Address"),name:"username",rules:[{required:!0,message:r("%s is required.",r("Username or email address")),whitespace:!0}],children:e.jsx(te,{})})}),e.jsx(a,{span:24,style:{textAlign:"right"},children:e.jsx(A,{children:e.jsx(d,{type:"primary",htmlType:"submit",loading:x==null?void 0:x.isLoading,children:r("Get New Password")})})})]})}),(t==null?void 0:t.disable_registration_form)!=="Y"?e.jsxs(e.Fragment,{children:[e.jsx(_,{style:{margin:"24px 0"}}),e.jsxs(p,{gap:"0 8px",align:"center",justify:"center",wrap:!0,children:[e.jsx(ne,{children:r("Don't have an account?")}),e.jsx(p,{gap:"0 8px",align:"center",wrap:!0,children:e.jsx(X,{className:"sg-anchor",to:"/register",children:r("Register Now")})})]})]}):null]})]})]})})})})})})})})}export{xe as default};
