import{b as K,u as O,p as U,_ as j,s as Z,d as ss,q as v,j as e,r as D,v as es,t as i,o as ts}from"../main.DB7J0o3m.1748844899215.js";import{c as f,d as E,s as as,L as W,F as Y,R as y,C as r,f as A,I as ns,Q as H,w as rs,B as w,ai as is,aa as ls,X as os,g as k,A as cs,e as P,i as S,j as ds,k as ps,h as ms,m as xs,T as hs,o as us,n as js}from"./antd.tbETyFFE.1748844899215.js";import{i as gs,r as C}from"./vendor.B47oQPyY.1748844899215.js";import"./toast.C9WEee-3.1748844899215.js";const{Content:ys}=W,{Text:_s,Title:bs}=hs,I=ts(),z="YYYY-MM-DD";function Bs(){const B=K(),G=gs(),[$]=f.useForm(),{getBasicSettings:V}=O(),[N,T]=C.useState(""),[q,F]=C.useState(""),[J,_]=U(),L=V(),m=(L==null?void 0:L.logged_user)||{},b=(m==null?void 0:m.custom_fields)||[],M={};for(const s of b){const a=(s==null?void 0:s.field_type)||"",x=(s==null?void 0:s.input_name)||"",t=(s==null?void 0:s.field_value)||"";if(a==="E")continue;let l=t;a==="N"?l=t?j.toNumber(t):"":a==="D"?l=t?E(t):"":a==="S"?l=t?!!t:!1:l=j.trim(t),M[x]=l}const Q={...M,first_name:(m==null?void 0:m.first_name)||"",last_name:(m==null?void 0:m.last_name)||""},X=s=>{var l,d;const a=((l=s==null?void 0:s.first_name)==null?void 0:l.trim())||"",x=((d=s==null?void 0:s.last_name)==null?void 0:d.trim())||"",t={};for(const n in s){const o=b.find(g=>(g==null?void 0:g.input_name)===n);if(o&&(j.has(o,"is_editable")?(o==null?void 0:o.is_editable)||!1:!0)){const p=(o==null?void 0:o.field_type)||"";p==="N"?t[n]=j.toString(s[n]):p==="D"?t[n]=E(s[n]).format(z):p==="S"?t[n]=s[n]?1:0:t[n]=j.trim(s[n])}}J({params:{action:"users_update"},data:{first_name:a,last_name:x,custom_fields:JSON.stringify(t)}})};return C.useEffect(()=>{var l,d,n,o;const{data:s,isLoading:a,isError:x,error:t}=_;B(a?Z():ss()),!a&&x&&((d=(l=t==null?void 0:t.data)==null?void 0:l.errors)!=null&&d.message)&&as.error((o=(n=t==null?void 0:t.data)==null?void 0:n.errors)==null?void 0:o.message),!a&&!x&&s&&s!=null&&s.msg&&(s!=null&&s.status?(T(""),F(s==null?void 0:s.msg),v()):(T(s==null?void 0:s.msg),F(""),v()))},[_,G,B]),e.jsx(W,{style:{background:"transparent",minHeight:I?"auto":"calc(100vh - 48px)",padding:"8px 0"},children:e.jsx(ys,{style:{padding:"0 8px"},children:e.jsx(Y,{vertical:!0,justify:"center",align:"center",style:{minHeight:I?"auto":"calc(100vh - 64px)"},children:e.jsx(y,{justify:"space-around",style:{width:"100%"},children:e.jsx(r,{span:24,style:{maxWidth:"620px"},children:e.jsx(y,{children:e.jsx(r,{span:24,children:e.jsxs(A,{size:"small",styles:{header:{background:"#fafafa"},body:{padding:"24px"}},style:{width:"100%"},children:[e.jsxs(y,{children:[I?null:e.jsx(r,{span:24,style:{textAlign:"center",marginBottom:"24px"},children:e.jsx("a",{href:D(),style:{display:"inline-block",lineHeight:0},children:e.jsx(ns,{src:es(),preview:!1,width:"auto",height:34})})}),e.jsxs(r,{span:24,children:[I?null:e.jsx(H,{style:{margin:"0 0 12px 0"}}),e.jsxs(y,{gutter:16,justify:"space-between",align:"middle",style:{marginBottom:"4px"},children:[e.jsx(r,{style:{paddingBottom:"8px"},children:e.jsxs(Y,{gap:"0 8px",wrap:!0,children:[e.jsx(rs,{title:i("Home"),children:e.jsx(w,{href:D(),icon:e.jsx(is,{})})}),e.jsx(w,{href:"#/change-password",icon:e.jsx(ls,{}),children:"Change Password"})]})}),e.jsx(r,{style:{paddingBottom:"8px"},children:e.jsx(w,{color:"primary",variant:"outlined",href:"#/",icon:e.jsx(os,{}),children:i("Back to Tickets")})})]}),e.jsx(H,{style:{margin:"0 0 24px 0"}})]})]}),e.jsxs(y,{children:[e.jsx(r,{span:24,children:e.jsx(bs,{level:5,style:{fontSize:"16px",margin:"0 0 12px 0"},children:i("Profile")})}),e.jsx(r,{span:24,children:e.jsx(A,{size:"small",styles:{body:{padding:0}},style:{borderColor:"#d9d9d9",marginBottom:"24px"},children:e.jsx(k,{itemLayout:"horizontal",dataSource:[m],renderItem:s=>e.jsx(k.Item,{style:{padding:"8px",margin:0},children:e.jsx(k.Item.Meta,{avatar:e.jsx(cs,{src:(s==null?void 0:s.img)||""}),title:s==null?void 0:s.name,description:s==null?void 0:s.email})}),className:"sg-ticket-users-list"})})}),e.jsx(r,{span:24,children:e.jsx(f,{form:$,name:"profile",layout:"vertical",onFinish:X,initialValues:Q,autoComplete:"off",children:e.jsxs(y,{gutter:16,children:[N?e.jsx(r,{span:24,children:e.jsx(P,{message:N,type:"error",showIcon:!0,closable:!0,afterClose:()=>T(""),style:{marginBottom:"24px"}})}):null,q?e.jsx(r,{span:24,children:e.jsx(P,{message:q,type:"success",showIcon:!1,closable:!0,afterClose:()=>F(""),style:{marginBottom:"24px"}})}):null,e.jsx(r,{span:12,children:e.jsx(f.Item,{label:i("First Name"),name:"first_name",rules:[{required:!0,message:i("%s is required.",i("First name")),whitespace:!0}],children:e.jsx(S,{})})}),e.jsx(r,{span:12,children:e.jsx(f.Item,{label:i("Last Name"),name:"last_name",rules:[{required:!0,message:i("%s is required.",i("Last name")),whitespace:!0}],children:e.jsx(S,{})})}),b==null?void 0:b.map(s=>{const a=(s==null?void 0:s.field_type)||"",x=(s==null?void 0:s.input_name)||"",t=(s==null?void 0:s.field_label)||"",l=(s==null?void 0:s.field_value)||"",d=(s==null?void 0:s.fld_option)||"",n=(s==null?void 0:s.help_text)||"",o=(s==null?void 0:s.is_required)==="Y",g=(s==null?void 0:s.is_half_field)==="Y",p=j.has(s,"is_editable")?(s==null?void 0:s.is_editable)||!1:!0;let u=[];x==="wc_store_id"?u=d==null?void 0:d.map(c=>({value:j.toString(c==null?void 0:c.id),label:c==null?void 0:c.title})):u=d?d.split(",").map(c=>({value:c,label:c})):[],a==="W"&&!u.find(c=>(c==null?void 0:c.value)===l)&&(u=[{value:"",label:`-- ${i("Select")} ---`},...u]);let h=null;a==="T"?h=e.jsx(S,{placeholder:n,disabled:!p}):a==="N"?h=e.jsx(us,{placeholder:n,disabled:!p,style:{width:"100%"}}):a==="D"?h=e.jsx(ds,{placeholder:n||i("Select date"),format:z,disabled:!p,style:{width:"100%"}}):a==="S"?h=e.jsx(js,{disabled:!p}):a==="R"?h=e.jsx(ps.Group,{options:u,disabled:!p}):a==="W"?h=e.jsx(ms,{placeholder:n||i("Select option"),options:u,disabled:!p,style:{width:"100%"}}):a==="U"&&(h=e.jsx(S,{disabled:!p}));const R={};return a==="R"&&(R.htmlFor=null),e.jsx(r,{span:g?12:24,children:a==="E"?e.jsx(_s,{style:{display:"block",marginBottom:"24px"},children:d}):e.jsx(f.Item,{label:t,name:x,rules:[{required:!!(p&&o),message:i("This field is required.")}],...R,children:h})},x)}),e.jsx(r,{span:24,style:{textAlign:"right"},children:e.jsx(xs,{children:e.jsx(w,{type:"primary",htmlType:"submit",loading:_==null?void 0:_.isLoading,children:i("Update")})})})]})})})]})]})})})})})})})})}export{Bs as default};
