import{an as N,j as e,t as n,_ as d,f as O,d as Y,r as $}from"../main.aHgQEcd5.1748844857753.js";import{r as p}from"./vendor.Cii7CkpR.1748844857753.js";import{t as G}from"./editor-value.B-WWB6lV.1748844857753.js";import{l as D}from"./license-email.WepaBGL0.1748844857753.js";import"./toast.D8JcjdRp.1748844857753.js";import{j as v,s as h,b as A,C as m,A as Q,o as q,u as j,B as L,t as J,a as M,L as B,F as U,d as H,ak as P,al as z,k as X,S as Z,Q as V,V as ee,E as se,T as ie}from"./antd.v1CHGtH-.1748844857753.js";function te({setIsLoading:l}){const w=[],E=[],x={apbd_wps_license_key:"",apbd_wps_license_email:D()},y={apbd_wps_license_key:"",apbd_wps_license_email:D()},[S]=v.useForm(),[F,b]=p.useState(!0),[g,c]=p.useState(""),[T,_]=N(),C=(i,r)=>{r=d.mapValues(r,function(s){return d.isString(s)?d.trim(s):s});for(const s of w){const o=i==null?void 0:i[s];o&&d.includes(o,"*")&&(r[s]=y[s])}for(const s of E)(i==null?void 0:i[s])&&(r[s]=G((i==null?void 0:i[s])||""));const t=d.pick(y,d.keys(r));d.isEqual(t,r)?b(!0):b(!1)},k=i=>{var s,o;const r=((s=i==null?void 0:i.apbd_wps_license_key)==null?void 0:s.trim())||"",t=((o=i==null?void 0:i.apbd_wps_license_email)==null?void 0:o.trim())||"";l(!0),T({params:{action:"activate_license"},data:{apbd_wps_license_key:r,apbd_wps_license_email:t}})};return p.useEffect(()=>{var o,a,f,u;const{data:i,isLoading:r,isError:t,error:s}=_;!r&&t&&((a=(o=s==null?void 0:s.data)==null?void 0:o.errors)!=null&&a.message)&&h.error((u=(f=s==null?void 0:s.data)==null?void 0:f.errors)==null?void 0:u.message),!r&&!t&&i&&(i!=null&&i.msg&&(i!=null&&i.status?(c(""),h.success(i==null?void 0:i.msg)):c(i==null?void 0:i.msg)),i!=null&&i.status||l(!1))},[_,l]),e.jsx(v,{form:S,name:"licenseActivateForm",layout:"vertical",autoComplete:"off",onFinish:k,onValuesChange:C,initialValues:x,children:e.jsxs(A,{children:[g?e.jsx(m,{span:24,children:e.jsx(Q,{message:g,type:"error",showIcon:!0,closable:!0,afterClose:()=>c(""),style:{marginBottom:"24px"}})}):null,e.jsx(m,{span:24,children:e.jsx(v.Item,{label:n("License Code"),name:"apbd_wps_license_key",rules:[{required:!0,message:n("%s is required.",n("License code")),whitespace:!0}],children:e.jsx(q,{})})}),e.jsx(m,{span:24,children:e.jsx(v.Item,{label:n("Email Address"),name:"apbd_wps_license_email",rules:[{required:!0,message:n("%s is required.",n("Email address")),whitespace:!0}],children:e.jsx(q,{})})}),e.jsx(m,{span:24,children:e.jsx(j,{children:e.jsx(L,{type:"primary",htmlType:"submit",loading:!1,disabled:F,children:n("Activate License")})})})]})})}const{Content:K}=B,{Text:W,Title:ne}=ie;function de(){const l=O(),{token:w}=J.useToken(),[E,x]=p.useState(!0),[y,S]=p.useState(!1),[F,b]=p.useState([]),{hasPermission:g}=Y(),c=$(t=>(t==null?void 0:t.license)||{}),{colorBgContainer:T,borderRadiusLG:_}=w||{},[C,k]=N(),i=()=>{x(!0),C({params:{action:"deactivate_license"}})},r=[{dataIndex:"label",key:"label",render:(t,s)=>e.jsxs(j,{direction:"vertical",children:[e.jsx(W,{style:{fontWeight:500},children:t}),l.xs||l.sm?e.jsx(W,{type:"secondary",children:s==null?void 0:s.value}):null]})},{dataIndex:"value",key:"value",responsive:["md"]}];return p.useEffect(()=>{const t=(c==null?void 0:c.isActive)||!1,s=(c==null?void 0:c.data)||null,o=s?[{key:"1",label:n("License Status"),value:s!=null&&s.is_valid?e.jsx(M,{color:"#87d068",children:n("Valid")}):e.jsx(M,{color:"#ff5500",children:n("Invalid")})},{key:"2",label:n("License Type"),value:(s==null?void 0:s.license_title)||""},{key:"3",label:n("License Expired on"),value:(s==null?void 0:s.expire_date)||""},{key:"4",label:n("Support Expired on"),value:(s==null?void 0:s.support_end)||""},{key:"5",label:n("Your License Key"),value:(s==null?void 0:s.license_key)||""}]:[];x(!1),S(t),b(o)},[c]),p.useEffect(()=>{var f,u,I,R;const{data:t,isLoading:s,isError:o,error:a}=k;!s&&o&&((u=(f=a==null?void 0:a.data)==null?void 0:f.errors)!=null&&u.message)&&h.error((R=(I=a==null?void 0:a.data)==null?void 0:I.errors)==null?void 0:R.message),!s&&!o&&t&&(t!=null&&t.msg&&(t!=null&&t.status?h.success(t==null?void 0:t.msg):h.error(t==null?void 0:t.msg)),t!=null&&t.status||x(!1))},[k]),e.jsx(B,{style:{background:"transparent",minHeight:l!=null&&l.wsm?"calc(100vh - 265px)":"calc(100vh - 210px)",padding:"16px 0"},children:e.jsx(K,{style:{padding:"0 16px"},children:e.jsx(U,{justify:"center",align:"center",style:{minHeight:l!=null&&l.wsm?"calc(100vh - 297px)":"calc(100vh - 242px)"},children:e.jsx(B,{style:{padding:"24px",background:T,borderRadius:_,maxWidth:"782px",width:"100%"},children:e.jsxs(K,{children:[e.jsxs(A,{gutter:16,justify:"space-between",align:"middle",style:{paddingBottom:"8px",marginBottom:"8px"},children:[e.jsx(m,{style:{paddingBottom:"8px"},children:e.jsx(ne,{level:5,style:{fontSize:"18px",margin:0},children:n("Manage License")})}),e.jsx(m,{style:{paddingBottom:"8px"},children:e.jsxs(j,{children:[e.jsx(H,{title:e.jsxs(j,{align:"center",children:[e.jsx(P,{}),e.jsx("span",{children:n("Learn more")})]}),children:e.jsx(L,{icon:e.jsx(P,{}),href:"https://supportgenix.com",target:"_blank"})}),e.jsx(H,{title:e.jsxs(j,{align:"center",children:[e.jsx(z,{}),e.jsx("span",{children:n("Documentation")})]}),children:e.jsx(L,{icon:e.jsx(z,{}),href:"https://supportgenix.com/docs/",target:"_blank"})})]})})]}),e.jsx(A,{children:e.jsx(m,{span:24,children:e.jsx(X,{size:"small",styles:{body:{padding:"20px 24px 24px 24px"}},children:e.jsx(Z,{spinning:E,style:{maxHeight:"unset"},children:y?e.jsxs(e.Fragment,{children:[e.jsx(V,{columns:r,dataSource:F,pagination:!1,bordered:!1,showHeader:!1,size:"small",className:"sg-license-table"}),g("all")?e.jsx(ee,{title:n("Deactivate license"),description:n("Are you sure want to deactivate license?"),onConfirm:i,okText:n("Yes"),cancelText:n("No"),icon:e.jsx(se,{style:{color:"#ff4d4f"}}),overlayStyle:{maxWidth:"300px"},children:e.jsx(L,{color:"danger",variant:"solid",style:{marginTop:"24px"},children:n("Deactivate License")})}):null]}):e.jsx(te,{setIsLoading:x})})})})})]})})})})})}export{de as default};
