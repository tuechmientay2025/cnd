import{u as K,ac as N,ad as Q,s as $,b as J,C as U,j as t,t as o,_ as d}from"../main.aHgQEcd5.1748844857753.js";import{r as l}from"./vendor.Cii7CkpR.1748844857753.js";import"./toast.D8JcjdRp.1748844857753.js";import{j as m,s as F,b as u,C as i,A as X,u as _,w as Y,o as Z,x as j,B as y,T as G,d as q,ak as R,al as A,k as V}from"./antd.v1CHGtH-.1748844857753.js";function tt(){const L=["api_token"],H={envato_status:!1,api_token:"",envato_form_opts:["is_required","support_expiry"],envato_display_opts:["show_in_tckt_form"]},b=K(),[x]=m.useForm(),[r,M]=l.useState(null),[h,E]=l.useState(null),[f,C]=l.useState(!0),[S,g]=l.useState(!0),[w,k]=l.useState(""),[O,I]=N(),{Text:P}=G,T=Q({action:"envato_system_data"}),v=(s,e)=>{e=d.mapValues(e,function(n){return d.isString(n)?d.trim(n):n});for(const n of L){const a=s==null?void 0:s[n];a&&d.includes(a,"*")&&(e[n]=r[n])}E(e||{}),C(!(e!=null&&e.envato_status)||!1);const c=d.pick(r,d.keys(e));d.isEqual(c,e)?g(!0):r!=null&&r.envato_status||e!=null&&e.envato_status?g(!1):g(!0)},z=async s=>{var p;const e=s!=null&&s.envato_status?"A":"I",c=((p=s==null?void 0:s.api_token)==null?void 0:p.trim())||"",n=(s==null?void 0:s.envato_form_opts)||[],a=(s==null?void 0:s.envato_display_opts)||[];O({params:{action:"envato_system"},data:{envato_status:e,api_token:c,envato_form_opts:n,envato_display_opts:a}})},W=()=>{x.setFieldsValue(r||{}),v(null,r)};return l.useEffect(()=>{x.setFieldsValue(r||{}),E(r||{}),C(!(r!=null&&r.envato_status)||!1),g(!0)},[r,x]),l.useEffect(()=>{var a,p;const{data:s,isFetching:e,isError:c,error:n}=T;!e&&c&&F.error((p=(a=n==null?void 0:n.data)==null?void 0:a.errors)==null?void 0:p.message),!e&&!c&&s&&M((s==null?void 0:s.data)||{})},[T]),l.useEffect(()=>{var a,p,B,D;const{data:s,isLoading:e,isError:c,error:n}=I;b(e?$():J()),!e&&c&&((p=(a=n==null?void 0:n.data)==null?void 0:a.errors)!=null&&p.message)&&F.error((D=(B=n==null?void 0:n.data)==null?void 0:B.errors)==null?void 0:D.message),!e&&!c&&s&&s!=null&&s.msg&&(s!=null&&s.status?(k(""),F.success(s==null?void 0:s.msg)):(k(s==null?void 0:s.msg),U()))},[I,b]),t.jsx(m,{form:x,name:"saveEnvato",layout:"vertical",autoComplete:"off",onFinish:z,onValuesChange:v,initialValues:H,children:t.jsxs(u,{children:[w?t.jsx(i,{span:24,children:t.jsx(X,{message:w,type:"error",showIcon:!0,closable:!0,afterClose:()=>k(""),style:{marginBottom:"24px"}})}):null,t.jsx(i,{span:24,children:t.jsxs(_,{align:"center",style:{marginBottom:"24px"},children:[t.jsx(m.Item,{name:"envato_status",valuePropName:"checked",style:{marginBottom:0},children:t.jsx(Y,{})}),t.jsx(P,{onClick:()=>{x.setFieldValue("envato_status",!(h!=null&&h.envato_status)),v(null,x.getFieldsValue())},style:{cursor:"pointer"},children:h!=null&&h.envato_status?o("Click to disable."):o("Click to enable and setup.")})]})}),t.jsx(i,{span:24,children:t.jsx(m.Item,{label:o("Envato API Token"),name:"api_token",rules:[{required:!0,message:o("%s is required.",o("Envato API token")),whitespace:!0}],help:f?"":void 0,tooltip:o("Value containing any asterisk (*) will not be updated."),children:t.jsx(Z,{disabled:f})})}),t.jsx(i,{span:24,children:t.jsx(m.Item,{label:o("Form Options"),name:"envato_form_opts",htmlFor:null,children:t.jsx(j.Group,{disabled:f,children:t.jsxs(u,{children:[t.jsx(i,{span:24,children:t.jsx(j,{value:"is_required",style:{lineHeight:"32px"},children:o("License Required")})}),t.jsx(i,{span:24,children:t.jsx(j,{value:"support_expiry",style:{lineHeight:"32px"},children:o("Check Support Expiry")})})]})})})}),t.jsx(i,{span:24,children:t.jsx(m.Item,{label:o("Display Options"),name:"envato_display_opts",htmlFor:null,children:t.jsx(j.Group,{disabled:f,children:t.jsxs(u,{children:[t.jsx(i,{span:24,children:t.jsx(j,{value:"show_in_tckt_form",style:{lineHeight:"32px"},children:o("Show in Ticket Form")})}),t.jsx(i,{span:24,children:t.jsx(j,{value:"show_in_reg_form",style:{lineHeight:"32px"},children:o("Show in Registration Form")})})]})})})}),t.jsx(i,{span:24,children:t.jsxs(_,{children:[t.jsx(y,{type:"primary",htmlType:"submit",loading:!1,disabled:S,children:o("Save Changes")}),t.jsx(y,{htmlType:"button",onClick:W,disabled:S,children:o("Discard")})]})})]})})}const{Title:st}=G;function rt(){return t.jsx(u,{justify:"space-around",children:t.jsxs(i,{span:24,style:{maxWidth:"960px"},children:[t.jsxs(u,{gutter:16,justify:"space-between",align:"middle",style:{paddingBottom:"8px",marginBottom:"8px"},children:[t.jsx(i,{style:{paddingBottom:"8px"},children:t.jsx(st,{level:5,style:{fontSize:"18px",margin:0},children:o("%s Integration",o("Envato"))})}),t.jsx(i,{style:{paddingBottom:"8px"},children:t.jsxs(_,{children:[t.jsx(q,{title:t.jsxs(_,{align:"center",children:[t.jsx(R,{}),t.jsx("span",{children:o("Learn more")})]}),children:t.jsx(y,{icon:t.jsx(R,{}),href:"https://supportgenix.com/integrations/envato/",target:"_blank"})}),t.jsx(q,{title:t.jsxs(_,{align:"center",children:[t.jsx(A,{}),t.jsx("span",{children:o("Documentation")})]}),children:t.jsx(y,{icon:t.jsx(A,{}),href:"https://supportgenix.com/doc/envato-integration/",target:"_blank"})})]})})]}),t.jsx(u,{children:t.jsx(i,{span:24,children:t.jsx(V,{size:"small",styles:{header:{background:"#fafafa"},body:{padding:"20px 24px 24px 24px"}},children:t.jsx(tt,{})})})})]})})}export{rt as default};
