import{j as e,t as s,u as ne,ak as ie,al as oe,_,s as ae,b as re,C as le,i as de,f as ke,x as v,M as V}from"../main.aHgQEcd5.1748844857753.js";import{r as p,u as be}from"./vendor.Cii7CkpR.1748844857753.js";import{j as y,s as M,i as z,b as Y,C as m,A as ce,u as j,w as O,F as me,aA as pe,B,y as he,D as Q,am as ye,T as Z,p as we,n as Fe,az as Ee,d as ee,ak as te,al as se,k as Ce,S as Se}from"./antd.v1CHGtH-.1748844857753.js";import{t as G}from"./editor-value.B-WWB6lV.1748844857753.js";import{w as Te,R as Ie,T as ue,g as xe}from"./withQuillEditorConfig.C5Id3VCK.1748844857753.js";import"./toast.D8JcjdRp.1748844857753.js";import{T as _e}from"./TimezoneAlert.D8hCZbBx.1748844857753.js";import{g as Be}from"./shortcode.DqNlmgdn.1748844857753.js";const We=Be("email-template-UOT"),De=Te(Ie,!0,We),ge=k=>e.jsx(De,{...k}),{Text:$}=Z,{RangePicker:Pe}=we,qe=xe(),Ne=de(),Le="YYYY-MM-DD",fe="HH:mm",J=`${Le} ${fe}`;function Me({setIsLoading:k}){const W=[],H={holiday_status:!1,holiday_ranges:[[]],holiday_portal_notice:!1,holiday_portal_content:s("Our office is currently closed for the holiday. While you're welcome to submit your ticket, please be aware that our team will review it when we return to the office. We thank you for your understanding and will respond to your request promptly upon our return."),holiday_email_notice:!1,holiday_email_content:"<p>Dear {{ticket_user}},</p><p>We wanted to let you know that our support team is currently out of office for the holiday. While your ticket has been successfully created, our team will review it when we return to the office.</p><p>Your request is important to us, and we will address it promptly upon our return.</p><p>Best regards,<br>{{site_name}}</p>"},S=ne(),[c]=y.useForm(),[l,N]=p.useState(null),[a,T]=p.useState(null),[o,I]=p.useState(!0),[D,b]=p.useState(!0),[P,w]=p.useState(""),[L,F]=ie(),q=oe({action:"weekend_data_holiday"}),g=(t,n)=>{n=_.mapValues(n,function(i){return _.isString(i)?_.trim(i):i});for(const i of W){const d=t==null?void 0:t[i];d&&_.includes(d,"*")&&(n[i]=l[i])}T(n||{}),I(!(n!=null&&n.holiday_status)||!1);const r=_.pick(l,_.keys(n));_.isEqual(r,n)?b(!0):l!=null&&l.holiday_status||n!=null&&n.holiday_status?b(!1):b(!0)},R=async t=>{var f,E;const n=t!=null&&t.holiday_status?"A":"I",r=(t==null?void 0:t.holiday_ranges)||[],i=t!=null&&t.holiday_portal_notice?"Y":"N",d=((f=t==null?void 0:t.holiday_portal_content)==null?void 0:f.trim())||"",u=t!=null&&t.holiday_email_notice?"Y":"N",x=G(((E=t==null?void 0:t.holiday_email_content)==null?void 0:E.trim())||"");if(u==="Y"&&!x){c.setFieldValue("holiday_email_content",""),w(s("%s is not valid.",s("Email notification content")));return}const h=r==null?void 0:r.map(C=>C==null?void 0:C.map(K=>z(K).format(J)));L({params:{action:"weekend_holiday"},data:{holiday_status:n,holiday_ranges:JSON.stringify(h),holiday_portal_notice:i,holiday_portal_content:d,holiday_email_notice:u,holiday_email_content:x}})},U=()=>{c.setFieldsValue(l||{}),g(null,l)};return p.useEffect(()=>{c.setFieldsValue(l||{}),T(l||{}),I(!(l!=null&&l.holiday_status)||!1),b(!0)},[l,c]),p.useEffect(()=>{var d,u,x;const{data:t,isFetching:n,isError:r,error:i}=q;if(k(n),!n&&r&&M.error((u=(d=i==null?void 0:i.data)==null?void 0:d.errors)==null?void 0:u.message),!n&&!r&&t){const h=_.clone((t==null?void 0:t.data)||{});h.holiday_ranges=(x=h==null?void 0:h.holiday_ranges)==null?void 0:x.map(f=>f==null?void 0:f.map(E=>z(E,J))),N(h||{})}},[q,k]),p.useEffect(()=>{var d,u,x,h;const{data:t,isLoading:n,isError:r,error:i}=F;S(n?ae():re()),!n&&r&&((u=(d=i==null?void 0:i.data)==null?void 0:d.errors)!=null&&u.message)&&M.error((h=(x=i==null?void 0:i.data)==null?void 0:x.errors)==null?void 0:h.message),!n&&!r&&t&&t!=null&&t.msg&&(t!=null&&t.status?(w(""),M.success(t==null?void 0:t.msg)):(w(t==null?void 0:t.msg),le()))},[F,S]),e.jsx(y,{form:c,name:"saveHoliday",layout:"vertical",autoComplete:"off",onFinish:R,onValuesChange:g,initialValues:H,children:e.jsxs(Y,{children:[P?e.jsx(m,{span:24,children:e.jsx(ce,{message:P,type:"error",showIcon:!0,closable:!0,afterClose:()=>w(""),style:{marginBottom:"24px"}})}):null,e.jsx(m,{span:24,children:e.jsxs(j,{align:"center",style:{marginBottom:"24px"},children:[e.jsx(y.Item,{name:"holiday_status",valuePropName:"checked",style:{marginBottom:0},children:e.jsx(O,{})}),e.jsx($,{onClick:()=>{c.setFieldValue("holiday_status",!(a!=null&&a.holiday_status)),g(null,c.getFieldsValue())},style:{cursor:"pointer"},children:a!=null&&a.holiday_status?s("Click to disable."):s("Click to enable and setup.")})]})}),o?null:e.jsx(m,{span:24,children:e.jsx(_e,{})}),e.jsxs(m,{span:24,children:[e.jsx(me,{align:"center",justify:"space-between",style:{marginBottom:"8px"},children:e.jsx($,{children:s("Date Ranges")})}),e.jsx(y.List,{name:"holiday_ranges",children:(t,{add:n,remove:r})=>e.jsxs(e.Fragment,{children:[t.map(({key:i,...d})=>e.jsxs(j,{style:{display:"flex"},align:"baseline",children:[e.jsx(y.Item,{...d,rules:[{required:!0,message:s("%s is required.",s("Date range"))}],help:o?"":void 0,style:{marginBottom:"12px"},children:e.jsx(Pe,{showNow:!0,showTime:{format:fe},format:J,disabled:o})}),!o&&t.length>1?e.jsx(pe,{className:"dynamic-delete-button",onClick:()=>r(d.name)}):null]},i)),e.jsx(y.Item,{children:e.jsx(B,{type:"dashed",onClick:()=>n(),icon:e.jsx(he,{}),disabled:o,children:s("Add More")})})]})})]}),e.jsx(m,{span:24,children:e.jsx(Q,{style:{margin:"0 0 24px 0"}})}),e.jsx(m,{span:24,children:e.jsxs(j,{align:"center",style:{marginBottom:"24px"},children:[e.jsx(y.Item,{name:"holiday_portal_notice",valuePropName:"checked",style:{marginBottom:0},children:e.jsx(O,{size:"small",disabled:o})}),e.jsx($,{onClick:()=>{o||(c.setFieldValue("holiday_portal_notice",!(a!=null&&a.holiday_portal_notice)),g(null,c.getFieldsValue()))},style:{cursor:o?"not-allowed":"pointer"},disabled:o,children:s("Enable portal notice.")})]})}),a!=null&&a.holiday_portal_notice?e.jsx(m,{span:24,children:e.jsx(y.Item,{label:s("Portal Notice Content"),name:"holiday_portal_content",rules:[{required:!0,message:s("%s is required.",s("Portal notice content")),whitespace:!0}],help:o?"":void 0,children:e.jsx(ye,{rows:2,disabled:o})})}):null,e.jsx(m,{span:24,children:e.jsx(Q,{style:{margin:"0 0 24px 0"}})}),e.jsx(m,{span:24,children:e.jsxs(j,{align:"center",style:{marginBottom:"24px"},children:[e.jsx(y.Item,{name:"holiday_email_notice",valuePropName:"checked",style:{marginBottom:0},children:e.jsx(O,{size:"small",disabled:o})}),e.jsx($,{onClick:()=>{o||(c.setFieldValue("holiday_email_notice",!(a!=null&&a.holiday_email_notice)),g(null,c.getFieldsValue()))},style:{cursor:o?"not-allowed":"pointer"},disabled:o,children:s("Enable email notification.")})]})}),a!=null&&a.holiday_email_notice?e.jsx(m,{span:24,children:e.jsx(y.Item,{label:s("Email Notification Content"),name:"holiday_email_content",rules:[{required:!0,message:s("%s is required.",s("Email notification content")),whitespace:!0},{validator:(t,n)=>{const r=G(n||"");return!n||r?Promise.resolve():Promise.reject(new Error(s("%s is not valid.",s("Email notification content"))))}}],htmlFor:null,children:!Ne&&qe==="quill"?e.jsx(ge,{readOnly:o,style:o?{color:"rgba(0, 0, 0, 0.25)",background:"rgba(0, 0, 0, 0.04)"}:null}):e.jsx(ue,{id:"holiday",kword:"email-template-UOT",disabled:o})})}):null,e.jsx(m,{span:24,children:e.jsxs(j,{children:[e.jsx(B,{type:"primary",htmlType:"submit",loading:!1,disabled:D,children:s("Save Changes")}),e.jsx(B,{htmlType:"button",onClick:U,disabled:D,children:s("Discard")})]})})]})})}const{Text:A}=Z,{RangePicker:Oe}=Ee,He=xe(),Re=de(),X="HH:mm";function Ye({setIsLoading:k}){const W=[],H={weekend_status:!1,weekend_days:[{day:6,time_range:[]},{day:7,time_range:[]}],weekend_portal_notice:!1,weekend_portal_content:s("Please note that our support team is currently out of office for the weekend. While you're welcome to submit your ticket, it will be reviewed when we return on the next business day. We appreciate your patience and will address your inquiry as soon as possible."),weekend_email_notice:!1,weekend_email_content:"<p>Dear {{ticket_user}},</p><p>We wanted to let you know that our support team is currently out of office for the weekend. While your ticket has been successfully created, our team will review it when we return on the next business day.</p><p>Your request is important to us, and we will address it as soon as we're back in the office.</p><p>Best regards,<br>{{site_name}}</p>"},S=ne(),[c]=y.useForm(),[l,N]=p.useState(null),[a,T]=p.useState(null),[o,I]=p.useState(!0),[D,b]=p.useState(!0),[P,w]=p.useState(""),[L,F]=ie(),q=oe({action:"weekend_data"}),g=(t,n)=>{n=_.mapValues(n,function(i){return _.isString(i)?_.trim(i):i});for(const i of W){const d=t==null?void 0:t[i];d&&_.includes(d,"*")&&(n[i]=l[i])}T(n||{}),I(!(n!=null&&n.weekend_status)||!1);const r=_.pick(l,_.keys(n));_.isEqual(r,n)?b(!0):l!=null&&l.weekend_status||n!=null&&n.weekend_status?b(!1):b(!0)},R=async t=>{var f,E;const n=t!=null&&t.weekend_status?"A":"I",r=(t==null?void 0:t.weekend_days)||[],i=t!=null&&t.weekend_portal_notice?"Y":"N",d=((f=t==null?void 0:t.weekend_portal_content)==null?void 0:f.trim())||"",u=t!=null&&t.weekend_email_notice?"Y":"N",x=G(((E=t==null?void 0:t.weekend_email_content)==null?void 0:E.trim())||"");if(u==="Y"&&!x){c.setFieldValue("weekend_email_content",""),w(s("%s is not valid.",s("Email notification content")));return}const h=r==null?void 0:r.map(C=>{var K;return{...C,time_range:(K=C==null?void 0:C.time_range)==null?void 0:K.map(je=>z(je).format(X))}});L({params:{action:"weekend"},data:{weekend_status:n,weekend_days:JSON.stringify(h),weekend_portal_notice:i,weekend_portal_content:d,weekend_email_notice:u,weekend_email_content:x}})},U=()=>{c.setFieldsValue(l||{}),g(null,l)};return p.useEffect(()=>{c.setFieldsValue(l||{}),T(l||{}),I(!(l!=null&&l.weekend_status)||!1),b(!0)},[l,c]),p.useEffect(()=>{var d,u,x;const{data:t,isFetching:n,isError:r,error:i}=q;if(k(n),!n&&r&&M.error((u=(d=i==null?void 0:i.data)==null?void 0:d.errors)==null?void 0:u.message),!n&&!r&&t){const h=_.clone((t==null?void 0:t.data)||{});h.weekend_days=(x=h==null?void 0:h.weekend_days)==null?void 0:x.map(f=>{var E;return{...f,time_range:(E=f==null?void 0:f.time_range)==null?void 0:E.map(C=>z(C,X))}}),N(h||{})}},[q,k]),p.useEffect(()=>{var d,u,x,h;const{data:t,isLoading:n,isError:r,error:i}=F;S(n?ae():re()),!n&&r&&((u=(d=i==null?void 0:i.data)==null?void 0:d.errors)!=null&&u.message)&&M.error((h=(x=i==null?void 0:i.data)==null?void 0:x.errors)==null?void 0:h.message),!n&&!r&&t&&t!=null&&t.msg&&(t!=null&&t.status?(w(""),M.success(t==null?void 0:t.msg)):(w(t==null?void 0:t.msg),le()))},[F,S]),e.jsx(y,{form:c,name:"saveWeekend",layout:"vertical",autoComplete:"off",onFinish:R,onValuesChange:g,initialValues:H,children:e.jsxs(Y,{children:[P?e.jsx(m,{span:24,children:e.jsx(ce,{message:P,type:"error",showIcon:!0,closable:!0,afterClose:()=>w(""),style:{marginBottom:"24px"}})}):null,e.jsx(m,{span:24,children:e.jsxs(j,{align:"center",style:{marginBottom:"24px"},children:[e.jsx(y.Item,{name:"weekend_status",valuePropName:"checked",style:{marginBottom:0},children:e.jsx(O,{})}),e.jsx(A,{onClick:()=>{c.setFieldValue("weekend_status",!(a!=null&&a.weekend_status)),g(null,c.getFieldsValue())},style:{cursor:"pointer"},children:a!=null&&a.weekend_status?s("Click to disable."):s("Click to enable and setup.")})]})}),o?null:e.jsx(m,{span:24,children:e.jsx(_e,{})}),e.jsxs(m,{span:24,children:[e.jsx(me,{align:"center",justify:"space-between",style:{marginBottom:"8px"},children:e.jsx(A,{children:s("Weekend Days")})}),e.jsx(y.List,{name:"weekend_days",children:(t,{add:n,remove:r})=>e.jsxs(e.Fragment,{children:[t.map(({key:i,name:d,...u})=>e.jsxs(j,{style:{display:"flex"},align:"baseline",children:[e.jsx(y.Item,{...u,name:[d,"day"],rules:[{required:!0,message:s("%s is required.",s("Day"))}],help:o?"":void 0,style:{marginBottom:"12px"},children:e.jsx(Fe,{defaultValue:"",options:[{value:"",label:`-- ${s("Select")} ---`},{value:6,label:s("Saturday")},{value:7,label:s("Sunday")},{value:1,label:s("Monday")},{value:2,label:s("Tuesday")},{value:3,label:s("Wednesday")},{value:4,label:s("Thursday")},{value:5,label:s("Friday")}],style:{width:"140px"},disabled:o})}),e.jsx(y.Item,{...u,name:[d,"time_range"],rules:[{required:!0,message:s("%s is required.",s("Time range"))}],help:o?"":void 0,style:{marginBottom:"12px"},children:e.jsx(Oe,{showNow:!0,format:X,disabled:o})}),!o&&t.length>1?e.jsx(pe,{className:"dynamic-delete-button",onClick:()=>r(d)}):null]},i)),e.jsx(y.Item,{children:e.jsx(B,{type:"dashed",onClick:()=>n(),icon:e.jsx(he,{}),disabled:o,children:s("Add More")})})]})})]}),e.jsx(m,{span:24,children:e.jsx(Q,{style:{margin:"0 0 24px 0"}})}),e.jsx(m,{span:24,children:e.jsxs(j,{align:"center",style:{marginBottom:"24px"},children:[e.jsx(y.Item,{name:"weekend_portal_notice",valuePropName:"checked",style:{marginBottom:0},children:e.jsx(O,{size:"small",disabled:o})}),e.jsx(A,{onClick:()=>{o||(c.setFieldValue("weekend_portal_notice",!(a!=null&&a.weekend_portal_notice)),g(null,c.getFieldsValue()))},style:{cursor:o?"not-allowed":"pointer"},disabled:o,children:s("Enable portal notice.")})]})}),a!=null&&a.weekend_portal_notice?e.jsx(m,{span:24,children:e.jsx(y.Item,{label:s("Portal Notice Content"),name:"weekend_portal_content",rules:[{required:!0,message:s("%s is required.",s("Portal notice content")),whitespace:!0}],help:o?"":void 0,children:e.jsx(ye,{rows:2,disabled:o})})}):null,e.jsx(m,{span:24,children:e.jsx(Q,{style:{margin:"0 0 24px 0"}})}),e.jsx(m,{span:24,children:e.jsxs(j,{align:"center",style:{marginBottom:"24px"},children:[e.jsx(y.Item,{name:"weekend_email_notice",valuePropName:"checked",style:{marginBottom:0},children:e.jsx(O,{size:"small",disabled:o})}),e.jsx(A,{onClick:()=>{o||(c.setFieldValue("weekend_email_notice",!(a!=null&&a.weekend_email_notice)),g(null,c.getFieldsValue()))},style:{cursor:o?"not-allowed":"pointer"},disabled:o,children:s("Enable email notification.")})]})}),a!=null&&a.weekend_email_notice?e.jsx(m,{span:24,children:e.jsx(y.Item,{label:s("Email Notification Content"),name:"weekend_email_content",rules:[{required:!0,message:s("%s is required.",s("Email notification content")),whitespace:!0},{validator:(t,n)=>{const r=G(n||"");return!n||r?Promise.resolve():Promise.reject(new Error(s("%s is not valid.",s("Email notification content"))))}}],htmlFor:null,children:!Re&&He==="quill"?e.jsx(ge,{readOnly:o,style:o?{color:"rgba(0, 0, 0, 0.25)",background:"rgba(0, 0, 0, 0.04)"}:null}):e.jsx(ue,{id:"weekend",kword:"email-template-UOT",disabled:o})})}):null,e.jsx(m,{span:24,children:e.jsxs(j,{children:[e.jsx(B,{type:"primary",htmlType:"submit",loading:!1,disabled:D,children:s("Save Changes")}),e.jsx(B,{htmlType:"button",onClick:U,disabled:D,children:s("Discard")})]})})]})})}const{Title:Ke}=Z;function Ze(){var L;const k=ke(),W=be(),[H,S]=p.useState(!0),[c,l]=p.useState(!0),[N,a]=p.useState(!0),[T,o]=p.useState(""),I=(L=v(W,"settings/weekend",["main"]))==null?void 0:L[0];function D(){const F=T||I||"",q={main:e.jsx(Ye,{setIsLoading:l}),holiday:e.jsx(Me,{setIsLoading:a})};return e.jsx(e.Fragment,{children:Object.entries(q).map(([g,R])=>e.jsx("div",{className:g===F?"":"sg-hidden",children:R},g))})}p.useEffect(()=>{!c&&!N&&S(!1)},[c,N]),p.useEffect(()=>{var F;o((F=v(W,"settings/weekend",["main"]))==null?void 0:F[0])},[W]);const b=[{key:"main",label:e.jsx(V,{to:"/settings/weekend",pro:!0,badge:!0,style:{color:"inherit"},children:s("Weekend")})},{key:"holiday",label:e.jsx(V,{to:"/settings/weekend/holiday",pro:!0,badge:!0,style:{color:"inherit"},children:s("Holiday")})}],P=()=>(T||I||"")==="holiday"?s("Holiday"):s("Weekend"),w=k.lg||k.xl||k.xxl?{tabList:b,activeTabKey:T,defaultActiveKey:I,tabProps:{size:"middle"}}:{title:P()};return e.jsx(Y,{justify:"space-around",children:e.jsxs(m,{span:24,style:{maxWidth:"960px"},children:[e.jsxs(Y,{gutter:16,justify:"space-between",align:"middle",style:{paddingBottom:"8px",marginBottom:"8px"},children:[e.jsx(m,{style:{paddingBottom:"8px"},children:e.jsx(Ke,{level:5,style:{fontSize:"18px",margin:0},children:s("Weekend & Holiday")})}),e.jsx(m,{style:{paddingBottom:"8px"},children:e.jsxs(j,{children:[e.jsx(ee,{title:e.jsxs(j,{align:"center",children:[e.jsx(te,{}),e.jsx("span",{children:s("Learn more")})]}),children:e.jsx(B,{icon:e.jsx(te,{}),href:"https://supportgenix.com",target:"_blank"})}),e.jsx(ee,{title:e.jsxs(j,{align:"center",children:[e.jsx(se,{}),e.jsx("span",{children:s("Documentation")})]}),children:e.jsx(B,{icon:e.jsx(se,{}),href:"https://supportgenix.com/docs/",target:"_blank"})})]})})]}),e.jsx(Y,{children:e.jsx(m,{span:24,children:e.jsx(Ce,{size:"small",...w,styles:{header:{background:"#fafafa",fontWeight:500},body:{padding:"20px 24px 24px 24px"}},children:e.jsx(Se,{spinning:H,style:{maxHeight:"unset"},children:D()})})})})]})})}export{Ze as default};
