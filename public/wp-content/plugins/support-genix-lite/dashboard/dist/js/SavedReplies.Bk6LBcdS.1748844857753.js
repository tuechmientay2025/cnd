import{j as e,u as ne,N as ie,s as ae,b as oe,c as ce,t as s,i as de,f as re,_ as me,O as ge}from"../main.aHgQEcd5.1748844857753.js";import{r,u as pe,k as ue}from"./vendor.Cii7CkpR.1748844857753.js";import{t as Z}from"./editor-value.B-WWB6lV.1748844857753.js";import{w as he,R as xe,T as fe,g as je}from"./withQuillEditorConfig.C5Id3VCK.1748844857753.js";import"./toast.D8JcjdRp.1748844857753.js";import{g as ye}from"./shortcode.DqNlmgdn.1748844857753.js";import{j as M,s as L,b as P,C as S,A as Se,o as Ce,w as we,u as $,B as C,F as _e,a as N,aa as K,$ as ee,Q as ve,T as le,n as Ee,X as Te,y as te,f as Re}from"./antd.v1CHGtH-.1748844857753.js";import{A as W}from"./Actionconfirm.BT5ZL47Y.1748844857753.js";const Be=ye("saved-reply"),Fe=he(xe,!0,Be),Ie=o=>e.jsx(Fe,{...o}),be=je(),Ae=de();function Le({data:o,isEdit:f,onCloseModal:i}){const j=o?{...o,status:(o==null?void 0:o.status)==="A"}:{status:!0},w=ne(),[B]=M.useForm(),[F,d]=r.useState(""),[I,g]=ie(),b=n=>{var l,y;const m=((l=n==null?void 0:n.title)==null?void 0:l.trim())||"",p=Z(((y=n==null?void 0:n.canned_msg)==null?void 0:y.trim())||""),u=n!=null&&n.status?"A":"I";if(!p){B.setFieldValue("canned_msg",""),d(s("%s is not valid.",s("Content")));return}I({params:{action:f?"canned_msg_edit":"canned_msg_add",id:j==null?void 0:j.id},data:{title:m,canned_msg:p,status:u}})};return r.useEffect(()=>{var l,y,_,v;const{data:n,isLoading:m,isError:p,error:u}=g;w(m?ae():oe()),!m&&p&&((y=(l=u==null?void 0:u.data)==null?void 0:l.errors)!=null&&y.message)&&L.error((v=(_=u==null?void 0:u.data)==null?void 0:_.errors)==null?void 0:v.message),!m&&!p&&n&&(n!=null&&n.msg&&(n!=null&&n.status?(d(""),L.success(n==null?void 0:n.msg)):(d(n==null?void 0:n.msg),ce())),n!=null&&n.status&&i())},[g,i,w]),e.jsx(M,{form:B,name:"createSavedReply",layout:"vertical",onFinish:b,initialValues:j,autoComplete:"off",children:e.jsxs(P,{gutter:16,children:[F?e.jsx(S,{span:24,children:e.jsx(Se,{message:F,type:"error",showIcon:!0,closable:!0,afterClose:()=>d(""),style:{marginBottom:"24px"}})}):null,e.jsx(S,{span:24,children:e.jsx(M.Item,{label:s("Title"),name:"title",rules:[{required:!0,message:s("%s is required.",s("Title")),whitespace:!0}],children:e.jsx(Ce,{})})}),e.jsx(S,{span:24,children:e.jsx(M.Item,{label:s("Content"),name:"canned_msg",rules:[{required:!0,message:s("%s is required.",s("Content")),whitespace:!0},{validator:(n,m)=>{const p=Z(m||"");return!m||p?Promise.resolve():Promise.reject(new Error(s("%s is not valid.",s("Content"))))}}],htmlFor:null,children:!Ae&&be==="quill"?e.jsx(Ie,{onModal:!0}):e.jsx(fe,{id:"saved-reply",kword:"saved-reply"})})}),e.jsx(S,{span:24,children:e.jsx(M.Item,{label:s("Status"),name:"status",valuePropName:"checked",children:e.jsx(we,{})})}),e.jsx(S,{span:24,style:{textAlign:"right"},children:e.jsxs($,{children:[e.jsx(C,{htmlType:"button",onClick:i,children:s("Cancel")}),e.jsx(C,{type:"primary",htmlType:"submit",loading:g==null?void 0:g.isLoading,children:f?s("Update"):s("Create")})]})})]})})}const{Text:se}=le;function ze({data:o,total:f,limit:i,page:j,onPageChange:w,onSizeChange:B,rowSelection:F,bulkAction:d,setBulkAction:I,bulkActionIds:g,onEditClick:b,isLoading:n,resetBulkAction:m,sortOrder:p,handleSort:u}){const l=re(),y=ne(),[_,v]=ie(),z=t=>{_({params:{action:"canned_msg_delete_item",id:t}})},G=()=>{let t="";d==="remove"?t="canned_msg_delete_items":d==="activate"?t="canned_msg_activate_items":d==="deactivate"&&(t="canned_msg_deactivate_items"),t&&_({params:{action:t,ids:g}})},U=(t,c,T,{action:h})=>{h==="sort"&&u(T)},k=t=>p===`${t}-asc`?"ascend":p===`${t}-desc`?"descend":null,V=[{title:s("ID"),dataIndex:"id",width:70,sorter:!0,sortDirections:["ascend","descend","ascend"],sortOrder:k("id")},{title:s("Title"),dataIndex:"title",sorter:!0,sortDirections:["ascend","descend","ascend"],sortOrder:k("title"),render:(t,c)=>e.jsxs($,{direction:"vertical",children:[e.jsx(se,{children:t}),l.xs||l.sm||l.md||l.lg?e.jsxs(e.Fragment,{children:[e.jsxs(_e,{gap:"0 8px",wrap:!0,children:[e.jsx(se,{children:s("Status:")}),(c==null?void 0:c.status)==="A"?e.jsx(N,{color:"green",children:s("Active")}):e.jsx(N,{color:"default",children:s("Inactive")})]}),l.xs?e.jsxs($,{children:[e.jsx(C,{type:"primary",icon:e.jsx(K,{}),size:"small",ghost:!0,onClick:()=>b(c)}),e.jsx(W,{action:"remove",onConfirm:()=>z(c==null?void 0:c.id),children:e.jsx(C,{type:"primary",icon:e.jsx(ee,{}),size:"small",danger:!0,ghost:!0})})]}):null]}):null]})},{title:s("Status"),dataIndex:"status",render:t=>t==="A"?e.jsx(N,{color:"green",children:s("Active")}):e.jsx(N,{color:"default",children:s("Inactive")}),responsive:["xl"]},{title:s("Action"),width:100,align:"right",render:t=>e.jsxs($,{children:[e.jsx(C,{type:"primary",icon:e.jsx(K,{}),size:"small",ghost:!0,onClick:()=>b(t)}),e.jsx(W,{action:"remove",onConfirm:()=>z(t==null?void 0:t.id),children:e.jsx(C,{type:"primary",icon:e.jsx(ee,{}),size:"small",danger:!0,ghost:!0})})]}),responsive:["sm"]}],E=()=>{const t=f?(j-1)*i+1:0,c=me.min([t+i-1,f]),T=s("Showing %1$d - %2$d of %3$d",t,c,f);return e.jsxs(P,{gutter:16,align:"middle",justify:"space-between",children:[e.jsx(S,{style:{marginTop:"4px",marginBottom:"4px"},children:e.jsxs(P,{align:"middle",gutter:8,children:[e.jsx(S,{children:e.jsx(Ee,{value:d,style:{width:140},onChange:h=>I(h),options:[{value:"",label:s("Bulk Actions")},{value:"activate",label:s("Activate")},{value:"deactivate",label:s("Deactivate")},{value:"remove",label:s("Delete")}],disabled:!(g!=null&&g.length)})}),e.jsx(S,{children:e.jsx(W,{action:d,onConfirm:()=>G(),children:e.jsx(C,{type:"primary",disabled:!d,children:s("Apply")})})})]})}),e.jsx(S,{style:{marginTop:"4px",marginBottom:"4px"},children:T})]})};return r.useEffect(()=>{var O,A,q,Q;const{data:t,isLoading:c,isError:T,error:h}=v;y(c?ae():oe()),!c&&T&&((A=(O=h==null?void 0:h.data)==null?void 0:O.errors)!=null&&A.message)&&L.error((Q=(q=h==null?void 0:h.data)==null?void 0:q.errors)==null?void 0:Q.message),!c&&!T&&t&&(t!=null&&t.msg&&(t!=null&&t.status?L.success(t==null?void 0:t.msg):L.error(t==null?void 0:t.msg)),t!=null&&t.status&&m())},[v,m,y]),e.jsx(ve,{rowKey:t=>t==null?void 0:t.id,rowSelection:F,columns:V,dataSource:o,footer:E,loading:n,onChange:U,pagination:{total:f,pageSize:i,current:j,onChange:w,onShowSizeChange:B,showSizeChanger:f>10,style:{marginBottom:0}}})}const{Title:Me}=le;function Ge(){const o=re(),f=pe(),[i,j]=ue(),[w,B]=r.useState((i==null?void 0:i.get("limit"))||20),[F,d]=r.useState((i==null?void 0:i.get("page"))||1),[I,g]=r.useState((i==null?void 0:i.get("sort"))||""),[b,n]=r.useState(""),[m,p]=r.useState([]),[u,l]=r.useState(!1),[y,_]=r.useState(null),[v,z]=r.useState(!1),[G,U]=r.useState(0),[k,V]=r.useState([]),E=ge({action:"canned_msg_data",limit:w,page:F,sort:I||"id-asc"}),t=r.useCallback(()=>{n(""),p([])},[]),c=a=>{a===1?i.delete("page"):i.set("page",a),d(a),j(i),t()},T=(a,x)=>{x===20?i.delete("limit"):i.set("limit",x),B(x),j(i),t()},h={selectedRowKeys:m,onChange:a=>{a!=null&&a.length||t(),p(a)}},O=a=>{_(a),z(!0),l(!0)},A=r.useCallback(()=>{l(!1),_(null),z(!1)},[]),q=()=>{E.refetch(),t()},Q=a=>{const{field:x,order:D}=a||{};let R=x;D==="ascend"?R+="-asc":R+="-desc",g(R),d(1),i.delete("page"),i.set("sort",R),j(i),t()};return r.useEffect(()=>{var X,H,J,Y;const{data:a,isFetching:x,isError:D,error:R}=E;!x&&D&&L.error((H=(X=R==null?void 0:R.data)==null?void 0:X.errors)==null?void 0:H.message),!x&&!D&&a&&(V((J=a==null?void 0:a.data)==null?void 0:J.result),U(((Y=a==null?void 0:a.data)==null?void 0:Y.total)||0))},[E]),r.useEffect(()=>{const{search:a}=f,x=new URLSearchParams(a);x.has("limit")||B(20),x.has("page")||d(1),x.has("sort")||g("")},[f]),e.jsxs(e.Fragment,{children:[e.jsxs(P,{gutter:16,justify:"space-between",align:"middle",style:{paddingBottom:"8px",marginBottom:"16px"},children:[e.jsx(S,{style:{paddingBottom:"8px"},children:e.jsx(Me,{level:5,style:{fontSize:"18px",margin:0},children:s("Saved Replies")})}),e.jsx(S,{style:{paddingBottom:"8px"},children:e.jsxs($,{children:[e.jsx(C,{type:"primary",icon:e.jsx(Te,{}),onClick:q,ghost:!0}),o!=null&&o.lg||o!=null&&o.xl||o!=null&&o.xxl?e.jsx(C,{type:"primary",icon:e.jsx(te,{}),onClick:()=>{l(!0)},children:s("Add New")}):e.jsx(C,{type:"primary",icon:e.jsx(te,{}),onClick:()=>{l(!0)}})]})})]}),e.jsx(ze,{data:k,total:G,limit:w,page:F,onPageChange:c,onSizeChange:T,rowSelection:h,bulkAction:b,setBulkAction:n,bulkActionIds:m,onEditClick:O,isLoading:E==null?void 0:E.isFetching,resetBulkAction:t,sortOrder:I,handleSort:Q}),e.jsx(Re,{title:v?s("Edit %s",s("Saved Reply")):s("Add New %s",s("Saved Reply")),centered:!0,open:u,onCancel:A,onClose:A,footer:null,width:800,style:{maxWidth:"calc(100vw - 32px)",marginTop:"40px",marginBottom:"40px"},destroyOnClose:!0,children:e.jsx(Le,{isOpen:u,onCloseModal:A,data:y,isEdit:v})})]})}export{Ge as default};
