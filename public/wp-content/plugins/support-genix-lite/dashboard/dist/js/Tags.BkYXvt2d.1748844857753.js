import{u as ne,H as ae,s as oe,b as re,c as ue,j as e,t as i,f as le,_ as he,n as K}from"../main.aHgQEcd5.1748844857753.js";import{r as o,u as pe,k as xe}from"./vendor.Cii7CkpR.1748844857753.js";import"./toast.D8JcjdRp.1748844857753.js";import{j as U,s as A,b as W,C as T,A as fe,o as je,w as Se,u as R,B as C,F as ye,a as H,aa as ee,$ as te,Q as Ce,T as ce,n as Te,X as _e,y as se,f as we}from"./antd.v1CHGtH-.1748844857753.js";import{A as V}from"./Actionconfirm.BT5ZL47Y.1748844857753.js";import{u as ve}from"./useGetFromParams.BFDdrSZN.1748844857753.js";function Fe({data:r,isEdit:x,onCloseModal:_}){const a=r?{...r,status:(r==null?void 0:r.status)==="A"}:{status:!0},w=ne(),[L]=U.useForm(),[B,g]=o.useState(""),[E,m]=ae(),b=n=>{var d;const f=((d=n==null?void 0:n.title)==null?void 0:d.trim())||"",y=n!=null&&n.status?"A":"I";E({params:{action:x?"ticket_tag_edit":"ticket_tag_add",id:a==null?void 0:a.id},data:{title:f,status:y}})};return o.useEffect(()=>{var j,S,k,F;const{data:n,isLoading:f,isError:y,error:d}=m;w(f?oe():re()),!f&&y&&((S=(j=d==null?void 0:d.data)==null?void 0:j.errors)!=null&&S.message)&&A.error((F=(k=d==null?void 0:d.data)==null?void 0:k.errors)==null?void 0:F.message),!f&&!y&&n&&(n!=null&&n.msg&&(n!=null&&n.status?(g(""),A.success(n==null?void 0:n.msg)):(g(n==null?void 0:n.msg),ue())),n!=null&&n.status&&_())},[m,_,w]),e.jsx(U,{form:L,name:"createTag",layout:"vertical",onFinish:b,initialValues:a,autoComplete:"off",children:e.jsxs(W,{gutter:16,children:[B?e.jsx(T,{span:24,children:e.jsx(fe,{message:B,type:"error",showIcon:!0,closable:!0,afterClose:()=>g(""),style:{marginBottom:"24px"}})}):null,e.jsx(T,{span:24,children:e.jsx(U.Item,{label:i("Title"),name:"title",rules:[{required:!0,message:i("%s is required.",i("Title")),whitespace:!0}],children:e.jsx(je,{})})}),e.jsx(T,{span:24,children:e.jsx(U.Item,{label:i("Status"),name:"status",valuePropName:"checked",children:e.jsx(Se,{})})}),e.jsx(T,{span:24,style:{textAlign:"right"},children:e.jsxs(R,{children:[e.jsx(C,{htmlType:"button",onClick:_,children:i("Cancel")}),e.jsx(C,{type:"primary",htmlType:"submit",loading:m==null?void 0:m.isLoading,children:x?i("Update"):i("Create")})]})})]})})}const{Text:ie}=ce;function Be({data:r,total:x,limit:_,page:a,onPageChange:w,onSizeChange:L,rowSelection:B,bulkAction:g,setBulkAction:E,bulkActionIds:m,onEditClick:b,isLoading:n,resetBulkAction:f,sortOrder:y,handleSort:d}){const j=le(),S=ne(),[k,F]=ae(),z=t=>{k({params:{action:"ticket_tag_delete_item",id:t}})},D=()=>{let t="";g==="remove"?t="ticket_tag_delete_items":g==="activate"?t="ticket_tag_activate_items":g==="deactivate"&&(t="ticket_tag_deactivate_items"),t&&k({params:{action:t,ids:m}})},X=(t,l,u,{action:h})=>{h==="sort"&&d(u)},G=t=>y===`${t}-asc`?"ascend":y===`${t}-desc`?"descend":null,J=[{title:i("ID"),dataIndex:"id",width:70,sorter:!0,sortDirections:["ascend","descend","ascend"],sortOrder:G("id")},{title:i("Title"),dataIndex:"title",sorter:!0,sortDirections:["ascend","descend","ascend"],sortOrder:G("title"),render:(t,l)=>e.jsxs(R,{direction:"vertical",children:[e.jsx(ie,{children:t}),j.xs||j.sm||j.md||j.lg?e.jsxs(e.Fragment,{children:[e.jsxs(ye,{gap:"0 8px",wrap:!0,children:[e.jsx(ie,{children:i("Status:")}),(l==null?void 0:l.status)==="A"?e.jsx(H,{color:"green",children:i("Active")}):e.jsx(H,{color:"default",children:i("Inactive")})]}),j.xs?e.jsxs(R,{children:[e.jsx(C,{type:"primary",icon:e.jsx(ee,{}),size:"small",ghost:!0,onClick:()=>b(l)}),e.jsx(V,{action:"remove",onConfirm:()=>z(l==null?void 0:l.id),children:e.jsx(C,{type:"primary",icon:e.jsx(te,{}),size:"small",danger:!0,ghost:!0})})]}):null]}):null]})},{title:i("Status"),dataIndex:"status",render:t=>t==="A"?e.jsx(H,{color:"green",children:i("Active")}):e.jsx(H,{color:"default",children:i("Inactive")}),responsive:["xl"]},{title:i("Action"),width:100,align:"right",render:t=>e.jsxs(R,{children:[e.jsx(C,{type:"primary",icon:e.jsx(ee,{}),size:"small",ghost:!0,onClick:()=>b(t)}),e.jsx(V,{action:"remove",onConfirm:()=>z(t==null?void 0:t.id),children:e.jsx(C,{type:"primary",icon:e.jsx(te,{}),size:"small",danger:!0,ghost:!0})})]}),responsive:["sm"]}],Y=()=>{const t=x?(a-1)*_+1:0,l=he.min([t+_-1,x]),u=i("Showing %1$d - %2$d of %3$d",t,l,x);return e.jsxs(W,{gutter:16,align:"middle",justify:"space-between",children:[e.jsx(T,{style:{marginTop:"4px",marginBottom:"4px"},children:e.jsxs(W,{align:"middle",gutter:8,children:[e.jsx(T,{children:e.jsx(Te,{value:g,style:{width:140},onChange:h=>E(h),options:[{value:"",label:i("Bulk Actions")},{value:"activate",label:i("Activate")},{value:"deactivate",label:i("Deactivate")},{value:"remove",label:i("Delete")}],disabled:!(m!=null&&m.length)})}),e.jsx(T,{children:e.jsx(V,{action:g,onConfirm:()=>D(),children:e.jsx(C,{type:"primary",disabled:!g,children:i("Apply")})})})]})}),e.jsx(T,{style:{marginTop:"4px",marginBottom:"4px"},children:u})]})};return o.useEffect(()=>{var v,N,q,Q;const{data:t,isLoading:l,isError:u,error:h}=F;S(l?oe():re()),!l&&u&&((N=(v=h==null?void 0:h.data)==null?void 0:v.errors)!=null&&N.message)&&A.error((Q=(q=h==null?void 0:h.data)==null?void 0:q.errors)==null?void 0:Q.message),!l&&!u&&t&&(t!=null&&t.msg&&(t!=null&&t.status?A.success(t==null?void 0:t.msg):A.error(t==null?void 0:t.msg)),t!=null&&t.status&&f())},[F,f,S]),e.jsx(Ce,{rowKey:t=>t==null?void 0:t.id,rowSelection:B,columns:J,dataSource:r,footer:Y,loading:n,onChange:X,pagination:{total:x,pageSize:_,current:a,onChange:w,onShowSizeChange:L,showSizeChanger:x>10,style:{marginBottom:0}}})}const{Title:Ee}=ce;function $e(){const r=le(),x=pe(),_=ve(),[a,w]=xe(),[L,B]=o.useState(_("limit",20)),[g,E]=o.useState((a==null?void 0:a.get("page"))||1),[m,b]=o.useState((a==null?void 0:a.get("sort"))||""),[n,f]=o.useState(""),[y,d]=o.useState([]),[j,S]=o.useState(!1),[k,F]=o.useState(null),[z,D]=o.useState(!1),[X,G]=o.useState(0),[J,Y]=o.useState([]),[t,l]=o.useState([]),u=K({action:"ticket_tag_data",limit:L,page:g,sort:m||"id-asc"}),h=K({action:"ticket_tag_data_for_select",select:!0}),v=o.useCallback(()=>{f(""),d([])},[]),N=s=>{s===1?a.delete("page"):a.set("page",s),E(s),w(a),v()},q=(s,c)=>{c===20?a.delete("limit"):a.set("limit",c),B(c),w(a),v()},Q={selectedRowKeys:y,onChange:s=>{s!=null&&s.length||v(),d(s)}},de=s=>{F(s),D(!0),S(!0)},Z=o.useCallback(()=>{S(!1),F(null),D(!1)},[]),ge=()=>{u.refetch(),v()},me=s=>{const{field:c,order:I}=s||{};let p=c;I==="ascend"?p+="-asc":p+="-desc",b(p),E(1),a.delete("page"),a.set("sort",p),w(a),v()};return o.useEffect(()=>{var $,M,O,P;const{data:s,isFetching:c,isError:I,error:p}=u;!c&&I&&A.error((M=($=p==null?void 0:p.data)==null?void 0:$.errors)==null?void 0:M.message),!c&&!I&&s&&(Y((O=s==null?void 0:s.data)==null?void 0:O.result),G(((P=s==null?void 0:s.data)==null?void 0:P.total)||0))},[u]),o.useEffect(()=>{var $,M,O,P;const{data:s,isFetching:c,isError:I,error:p}=h;!c&&I&&A.error((M=($=p==null?void 0:p.data)==null?void 0:$.errors)==null?void 0:M.message),!c&&!I&&s&&s!=null&&s.status&&(O=s==null?void 0:s.data)!=null&&O.result&&l((P=s==null?void 0:s.data)==null?void 0:P.result)},[h]),o.useEffect(()=>{const{search:s}=x,c=new URLSearchParams(s);c.has("limit")||B(20),c.has("page")||E(1),c.has("sort")||b("")},[x]),e.jsxs(e.Fragment,{children:[e.jsxs(W,{gutter:16,justify:"space-between",align:"middle",style:{paddingBottom:"8px",marginBottom:"16px"},children:[e.jsx(T,{style:{paddingBottom:"8px"},children:e.jsx(Ee,{level:5,style:{fontSize:"18px",margin:0},children:i("Tags")})}),e.jsx(T,{style:{paddingBottom:"8px"},children:e.jsxs(R,{children:[e.jsx(C,{type:"primary",icon:e.jsx(_e,{}),onClick:ge,ghost:!0}),r!=null&&r.lg||r!=null&&r.xl||r!=null&&r.xxl?e.jsx(C,{type:"primary",icon:e.jsx(se,{}),onClick:()=>{S(!0)},children:i("Add New")}):e.jsx(C,{type:"primary",icon:e.jsx(se,{}),onClick:()=>{S(!0)}})]})})]}),e.jsx(Be,{data:J,total:X,limit:L,page:g,onPageChange:N,onSizeChange:q,rowSelection:Q,bulkAction:n,setBulkAction:f,bulkActionIds:y,onEditClick:de,isLoading:u==null?void 0:u.isFetching,resetBulkAction:v,sortOrder:m,handleSort:me}),e.jsx(we,{title:z?i("Edit %s",i("Tag")):i("Add New %s",i("Tag")),centered:!0,open:j,onCancel:Z,onClose:Z,footer:null,width:800,style:{maxWidth:"calc(100vw - 32px)",marginTop:"40px",marginBottom:"40px"},destroyOnClose:!0,children:e.jsx(Fe,{isOpen:j,onCloseModal:Z,data:k,isEdit:z,tagSelectList:t})})]})}export{$e as default};
