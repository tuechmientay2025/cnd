import{_ as z,u as Y,R as J,s as K,b as Z,c as D,j as e,t as i,f as v,S as V,m as ee}from"../main.aHgQEcd5.1748844857753.js";import{r as d}from"./vendor.Cii7CkpR.1748844857753.js";import"./toast.D8JcjdRp.1748844857753.js";import{C as se}from"./CopyButton.BHPgmrhV.1748844857753.js";import{j as k,s as E,b as P,C as c,A as R,o as G,D as $,u as B,w as O,n as te,x as ie,B as M,T as W,k as H,aa as ae,$ as oe,F,a as N,S as ne,au as Q,X as re,y as U,f as le}from"./antd.v1CHGtH-.1748844857753.js";import{A as ce}from"./Actionconfirm.BT5ZL47Y.1748844857753.js";const{Text:me}=W;function he({data:a,isEdit:I,onCloseModal:j,categorySelectList:A}){const o=a?{...a,attach_with:(a==null?void 0:a.attach_with)==="A",choose_category:z.toInteger(a==null?void 0:a.choose_category)?a.choose_category:"",status:(a==null?void 0:a.status)==="A"}:{attach_with:!1,choose_category:"",status:!0},w=Y(),[b]=k.useForm(),[S,s]=d.useState(""),[h,C]=d.useState(o==null?void 0:o.attach_with),[r,l]=J(),x=t=>{z.has(t,"attach_with")&&C(t==null?void 0:t.attach_with)},y=t=>{var g,T,q;const n=((g=t==null?void 0:t.title)==null?void 0:g.trim())||"",u=((T=t==null?void 0:t.connected_email)==null?void 0:T.trim())||"",m=t!=null&&t.attach_with?"A":"I",p=((q=t==null?void 0:t.choose_category)==null?void 0:q.trim())||"0",f=t!=null&&t.privacy_policy?"Y":"N",_=t!=null&&t.status?"A":"I";r({params:{action:I?"email_to_ticket_edit":"email_to_ticket_add",id:o==null?void 0:o.id},data:{title:n,connected_email:u,attach_with:m,choose_category:p,privacy_policy:f,status:_}})};return d.useEffect(()=>{var p,f,_,g;const{data:t,isLoading:n,isError:u,error:m}=l;w(n?K():Z()),!n&&u&&((f=(p=m==null?void 0:m.data)==null?void 0:p.errors)!=null&&f.message)&&E.error((g=(_=m==null?void 0:m.data)==null?void 0:_.errors)==null?void 0:g.message),!n&&!u&&t&&(t!=null&&t.msg&&(t!=null&&t.status?(s(""),E.success(t==null?void 0:t.msg)):(s(t==null?void 0:t.msg),D())),t!=null&&t.status&&j())},[l,j,w]),e.jsx(k,{form:b,name:"createMailbox",layout:"vertical",onFinish:y,onValuesChange:x,initialValues:o,autoComplete:"off",children:e.jsxs(P,{gutter:16,children:[S?e.jsx(c,{span:24,children:e.jsx(R,{message:S,type:"error",showIcon:!0,closable:!0,afterClose:()=>s(""),style:{marginBottom:"24px"}})}):null,e.jsx(c,{span:24,children:e.jsx(k.Item,{label:i("Title"),name:"title",rules:[{required:!0,message:i("%s is required.",i("Title")),whitespace:!0}],children:e.jsx(G,{})})}),e.jsx(c,{span:24,children:e.jsx(R,{type:"success",message:(o==null?void 0:o.email)||i("The mailbox address will be generated here automatically!"),action:o!=null&&o.email?e.jsx(se,{text:o==null?void 0:o.email,style:{marginLeft:"16px"}}):null,style:{marginBottom:"24px"}})}),e.jsxs(c,{span:24,children:[e.jsx(k.Item,{label:i("Connected Email Address"),name:"connected_email",rules:[{required:!0,message:i("%s is required.",i("Connected email address")),whitespace:!0},{type:"email",message:i("Please enter a valid email.")}],style:{marginBottom:"8px"},children:e.jsx(G,{})}),e.jsx(R,{type:"info",message:i("Upon saving, when the mailbox address is generated, please forward your support emails from connected email address to the mailbox address."),style:{marginBottom:"24px"}})]}),e.jsx(c,{span:24,children:e.jsx($,{style:{margin:"0 0 24px 0"}})}),e.jsx(c,{span:24,children:e.jsxs(B,{align:"center",style:{marginBottom:"24px"},children:[e.jsx(k.Item,{name:"attach_with",valuePropName:"checked",style:{marginBottom:0},children:e.jsx(O,{size:"small"})}),e.jsx(me,{onClick:()=>{b.setFieldValue("attach_with",!h),x({attach_with:!h})},style:{cursor:"pointer"},children:i("Attached with ticket category.")})]})}),h?e.jsx(c,{span:24,children:e.jsx(k.Item,{label:i("Choose Category"),name:"choose_category",rules:[{required:!0,message:i("%s is required.",i("Category")),whitespace:!0}],children:e.jsx(te,{options:A})})}):null,e.jsx(c,{span:24,children:e.jsx($,{style:{margin:"0 0 24px 0"}})}),e.jsx(c,{span:24,children:e.jsx(k.Item,{name:"privacy_policy",valuePropName:"checked",children:e.jsx(ie,{children:e.jsx("span",{dangerouslySetInnerHTML:{__html:i("I agree with the Support Genix email to ticket %sterms and conditions%s.",'<a class="sg-anchor" target="_blank" href="https://supportgenix.com/privacy-policy/email-to-ticket-data-policy/">',"</a>")}})})})}),e.jsx(c,{span:24,children:e.jsx(k.Item,{label:i("Status"),name:"status",valuePropName:"checked",children:e.jsx(O,{})})}),e.jsx(c,{span:24,style:{textAlign:"right"},children:e.jsxs(B,{children:[e.jsx(M,{htmlType:"button",onClick:j,children:i("Cancel")}),e.jsx(M,{type:"primary",htmlType:"submit",loading:l==null?void 0:l.isLoading,children:I?i("Update"):i("Create")})]})})]})})}const{Text:L,Paragraph:X}=W;function xe({data:a,onEditClick:I,isLoading:j,categorySelectList:A}){const o=Y(),[w,b]=J(),S=s=>{w({params:{action:"email_to_ticket_delete_item",id:s}})};return d.useEffect(()=>{var l,x,y,t;const{data:s,isLoading:h,isError:C,error:r}=b;o(h?K():Z()),!h&&C&&((x=(l=r==null?void 0:r.data)==null?void 0:l.errors)!=null&&x.message)&&E.error((t=(y=r==null?void 0:r.data)==null?void 0:y.errors)==null?void 0:t.message),!h&&!C&&s&&s!=null&&s.msg&&(s!=null&&s.status?E.success(s==null?void 0:s.msg):E.error(s==null?void 0:s.msg))},[b,o]),a?e.jsx(P,{gutter:16,children:a==null?void 0:a.map(s=>{const h=(s==null?void 0:s.status)==="A",C=(s==null?void 0:s.attach_with)==="A",r=(s==null?void 0:s.choose_category)||"0";let l=i("N/A");if(C&&r!=="0"){const x=A==null?void 0:A.find(({value:y})=>y===r);x?l=x==null?void 0:x.label:l=r}return e.jsx(c,{xs:24,lg:12,xxl:8,children:e.jsx(H,{size:"small",title:s==null?void 0:s.title,extra:e.jsxs(B,{style:{marginLeft:"8px"},children:[e.jsx(M,{type:"primary",icon:e.jsx(ae,{}),size:"small",ghost:!0,onClick:()=>I(s)}),e.jsx(ce,{action:"remove",onConfirm:()=>S(s==null?void 0:s.id),children:e.jsx(M,{type:"primary",icon:e.jsx(oe,{}),size:"small",danger:!0,ghost:!0})})]}),styles:{header:{background:"#fafafa",fontWeight:500}},style:{marginTop:"16px"},children:e.jsxs(B,{direction:"vertical",children:[e.jsx(R,{type:"info",message:i("Please make sure that support emails from connected address are forwared to mailbox address."),style:{marginBottom:"4px"}}),e.jsxs(F,{gap:"0 8px",wrap:!0,children:[e.jsx(L,{style:{fontWeight:500},children:i("Address:")}),e.jsx(X,{copyable:!0,style:{margin:0},children:(s==null?void 0:s.email)||""})]}),e.jsxs(F,{gap:"0 8px",wrap:!0,children:[e.jsx(L,{style:{fontWeight:500},children:i("Connected:")}),e.jsx(X,{style:{margin:0},children:(s==null?void 0:s.connected_email)||""})]}),e.jsxs(F,{gap:"0 8px",wrap:!0,children:[e.jsx(L,{style:{fontWeight:500},children:i("Category:")}),e.jsx(N,{bordered:!1,children:l})]}),e.jsxs(F,{gap:"0 8px",wrap:!0,children:[e.jsx(L,{style:{fontWeight:500},children:i("Status:")}),h?e.jsx(N,{color:"green",children:i("Active")}):e.jsx(N,{color:"default",children:i("Inactive")})]})]})})},s==null?void 0:s.id)})}):e.jsx(P,{children:e.jsx(c,{span:24,children:e.jsx(H,{size:"small",style:{marginTop:"16px"},children:e.jsx(ne,{spinning:j,style:{maxHeight:"unset"},children:e.jsx(Q,{image:Q.PRESENTED_IMAGE_SIMPLE})})})})})}const{Title:pe}=W;function _e(){const a=v(),[I,j]=d.useState(!1),[A,o]=d.useState(null),[w,b]=d.useState(!1),[S,s]=d.useState([]),[h,C]=d.useState([]),r=V({action:"email_to_ticket_data"}),l=ee({action:"ticket_category_data_for_select",select:!0}),x=n=>{o(n),b(!0),j(!0)},y=d.useCallback(()=>{j(!1),o(null),b(!1)},[]),t=()=>{r.refetch()};return d.useEffect(()=>{var f,_,g;const{data:n,isFetching:u,isError:m,error:p}=r;!u&&m&&E.error((_=(f=p==null?void 0:p.data)==null?void 0:f.errors)==null?void 0:_.message),!u&&!m&&n&&s((g=n==null?void 0:n.data)==null?void 0:g.result)},[r]),d.useEffect(()=>{var f,_,g,T;const{data:n,isFetching:u,isError:m,error:p}=l;!u&&m&&E.error((_=(f=p==null?void 0:p.data)==null?void 0:f.errors)==null?void 0:_.message),!u&&!m&&n&&n!=null&&n.status&&(g=n==null?void 0:n.data)!=null&&g.result&&C((T=n==null?void 0:n.data)==null?void 0:T.result)},[l]),e.jsxs(e.Fragment,{children:[e.jsxs(P,{gutter:16,justify:"space-between",align:"middle",style:{paddingBottom:"8px",marginBottom:0},children:[e.jsx(c,{style:{paddingBottom:"8px"},children:e.jsx(pe,{level:5,style:{fontSize:"18px",margin:0},children:i("Mailboxes (Modern)")})}),e.jsx(c,{style:{paddingBottom:"8px"},children:e.jsxs(B,{children:[e.jsx(M,{type:"primary",icon:e.jsx(re,{}),onClick:t,ghost:!0}),a!=null&&a.lg||a!=null&&a.xl||a!=null&&a.xxl?e.jsx(M,{type:"primary",icon:e.jsx(U,{}),onClick:()=>{j(!0)},children:i("Add New")}):e.jsx(M,{type:"primary",icon:e.jsx(U,{}),onClick:()=>{j(!0)}})]})})]}),e.jsx(xe,{data:S,onEditClick:x,isLoading:r==null?void 0:r.isFetching,categorySelectList:h}),e.jsx(le,{title:w?i("Edit %s",i("Mailbox")):i("Add New %s",i("Mailbox")),centered:!0,open:I,onCancel:y,onClose:y,footer:null,width:800,style:{maxWidth:"calc(100vw - 32px)",marginTop:"40px",marginBottom:"40px"},destroyOnClose:!0,children:e.jsx(he,{isOpen:I,onCloseModal:y,data:A,isEdit:w,categorySelectList:h})})]})}export{_e as default};
