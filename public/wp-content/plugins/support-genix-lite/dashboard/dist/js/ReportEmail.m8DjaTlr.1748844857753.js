import{u as v,ai as V,aj as ee,_ as d,s as te,b as se,C as ie,j as e,t as s}from"../main.aHgQEcd5.1748844857753.js";import{i as C,j as p,s as I,b as k,C as o,A as ne,u as j,w as re,n as L,v as P,az as oe,D as ae,o as de,B as q,T as N,d as G,ak as H,al as K,k as le}from"./antd.v1CHGtH-.1748844857753.js";import{r as u}from"./vendor.Cii7CkpR.1748844857753.js";import{t as me}from"./editor-value.B-WWB6lV.1748844857753.js";import{l as ce}from"./license-email.WepaBGL0.1748844857753.js";import"./toast.D8JcjdRp.1748844857753.js";import{T as pe}from"./TimezoneAlert.D8hCZbBx.1748844857753.js";const _="HH:mm";function ue(){const O=[],Q=[],U={status:!1,frequency:"daily",weak_day:1,month_day:1,day_time:C("00:00",_),custom_minutes:5,recipients:ce()},E=v(),[y]=p.useForm(),[r,$]=u.useState(null),[h,S]=u.useState(null),[a,T]=u.useState(!0),[D,f]=u.useState(!0),[R,F]=u.useState(""),[b,B]=u.useState("daily"),[J,M]=V(),{Text:X}=N,W=ee({action:"report_email_data"}),w=(t,i)=>{i=d.mapValues(i,function(n){return d.isString(n)?d.trim(n):n});for(const n of O){const l=t==null?void 0:t[n];l&&d.includes(l,"*")&&(i[n]=r[n])}for(const n of Q)(t==null?void 0:t[n])&&(i[n]=me((t==null?void 0:t[n])||""));S(i||{}),T(!(i!=null&&i.status)||!1),B((i==null?void 0:i.frequency)||"daily");const c=d.pick(r,d.keys(i));d.isEqual(c,i)?f(!0):r!=null&&r.status||i!=null&&i.status?f(!1):f(!0)},Y=async t=>{var z,A;const i=t!=null&&t.status?"A":"I",c=((z=t==null?void 0:t.recipients)==null?void 0:z.trim())||"",n=((A=t==null?void 0:t.frequency)==null?void 0:A.trim())||"",l=d.toInteger((t==null?void 0:t.weak_day)||0)||0,x=d.toInteger((t==null?void 0:t.month_day)||0)||0,m=C(t==null?void 0:t.day_time).format(_),g=d.toInteger((t==null?void 0:t.custom_minutes)||0)||0;J({params:{action:"report_email"},data:{status:i,recipients:c,frequency:n,weak_day:l,month_day:x,day_time:m,custom_minutes:g}})},Z=()=>{y.setFieldsValue(r||{}),w(null,r)};return u.useEffect(()=>{y.setFieldsValue(r||{}),S(r||{}),T(!(r!=null&&r.status)||!1),B((r==null?void 0:r.frequency)||"daily"),f(!0)},[r,y]),u.useEffect(()=>{var l,x;const{data:t,isFetching:i,isError:c,error:n}=W;if(!i&&c&&I.error((x=(l=n==null?void 0:n.data)==null?void 0:l.errors)==null?void 0:x.message),!i&&!c&&t){const m=d.clone((t==null?void 0:t.data)||{});m.day_time=C(m==null?void 0:m.day_time,_),$(m||{})}},[W]),u.useEffect(()=>{var l,x,m,g;const{data:t,isLoading:i,isError:c,error:n}=M;E(i?te():se()),!i&&c&&((x=(l=n==null?void 0:n.data)==null?void 0:l.errors)!=null&&x.message)&&I.error((g=(m=n==null?void 0:n.data)==null?void 0:m.errors)==null?void 0:g.message),!i&&!c&&t&&t!=null&&t.msg&&(t!=null&&t.status?(F(""),I.success(t==null?void 0:t.msg)):(F(t==null?void 0:t.msg),ie()))},[M,E]),e.jsx(p,{form:y,name:"saveReportEmail",layout:"vertical",autoComplete:"off",onFinish:Y,onValuesChange:w,initialValues:U,children:e.jsxs(k,{children:[R?e.jsx(o,{span:24,children:e.jsx(ne,{message:R,type:"error",showIcon:!0,closable:!0,afterClose:()=>F(""),style:{marginBottom:"24px"}})}):null,e.jsx(o,{span:24,children:e.jsxs(j,{align:"center",style:{marginBottom:"24px"},children:[e.jsx(p.Item,{name:"status",valuePropName:"checked",style:{marginBottom:0},children:e.jsx(re,{})}),e.jsx(X,{onClick:()=>{y.setFieldValue("status",!(h!=null&&h.status)),w(null,y.getFieldsValue())},style:{cursor:"pointer"},children:h!=null&&h.status?s("Click to disable."):s("Click to enable and setup.")})]})}),a?null:e.jsx(o,{span:24,children:e.jsx(pe,{})}),e.jsx(o,{span:24,children:e.jsx(p.Item,{label:s("Report Schedule"),name:"frequency",rules:[{required:!0,message:s("%s is required.",s("Report schedule"))}],help:a?"":void 0,children:e.jsx(L,{style:{width:"160px"},options:[{value:"custom",label:s("Custom Minutes")},{value:"hourly",label:s("Hourly")},{value:"daily",label:s("Daily")},{value:"weekly",label:s("Weekly")},{value:"monthly",label:s("Monthly")}],disabled:a})})}),b==="weekly"?e.jsx(o,{span:24,children:e.jsx(p.Item,{label:s("Day of Week"),name:"weak_day",rules:[{required:!0,message:s("%s is required.",s("Day of week"))}],help:a?"":void 0,children:e.jsx(L,{style:{width:"100%"},options:[{value:1,label:s("Monday")},{value:2,label:s("Tuesday")},{value:3,label:s("Wednesday")},{value:4,label:s("Thursday")},{value:5,label:s("Friday")},{value:6,label:s("Saturday")},{value:7,label:s("Sunday")}],disabled:a})})}):null,b==="monthly"?e.jsx(o,{span:24,children:e.jsx(p.Item,{label:s("Day of Month"),name:"month_day",rules:[{required:!0,message:s("%s is required.",s("Day of month"))}],help:a?"":void 0,tooltip:s("Enter a value between 1 and 31."),children:e.jsx(P,{min:1,max:31,style:{minWidth:"125px"},disabled:a})})}):null,d.includes(["daily","weekly","monthly"],b)?e.jsx(o,{span:24,children:e.jsx(p.Item,{label:s("Time"),name:"day_time",rules:[{required:!0,message:s("%s is required.",s("Time"))}],help:a?"":void 0,children:e.jsx(oe,{format:_,disabled:a})})}):null,b==="custom"?e.jsx(o,{span:24,children:e.jsx(p.Item,{label:s("Custom Minutes"),name:"custom_minutes",rules:[{required:!0,message:s("%s is required.",s("Custom minutes"))}],help:a?"":void 0,tooltip:s("Enter a value between 5 and 60."),children:e.jsx(P,{min:5,max:60,style:{minWidth:"125px"},disabled:a})})}):null,e.jsx(ae,{style:{margin:"0 0 24px 0"}}),e.jsx(o,{span:24,children:e.jsx(p.Item,{label:s("Recipients"),name:"recipients",rules:[{required:!0,message:s("%s is required.",s("User email")),whitespace:!0}],tooltip:s("Comma separated email addresses."),children:e.jsx(de,{disabled:a})})}),e.jsx(o,{span:24,children:e.jsxs(j,{children:[e.jsx(q,{type:"primary",htmlType:"submit",loading:!1,disabled:D,children:s("Save Changes")}),e.jsx(q,{htmlType:"button",onClick:Z,disabled:D,children:s("Discard")})]})})]})})}const{Title:xe}=N;function ke(){return e.jsx(k,{justify:"space-around",children:e.jsxs(o,{span:24,style:{maxWidth:"960px"},children:[e.jsxs(k,{gutter:16,justify:"space-between",align:"middle",style:{paddingBottom:"8px",marginBottom:"8px"},children:[e.jsx(o,{style:{paddingBottom:"8px"},children:e.jsx(xe,{level:5,style:{fontSize:"18px",margin:0},children:s("Performance Insights")})}),e.jsx(o,{style:{paddingBottom:"8px"},children:e.jsxs(j,{children:[e.jsx(G,{title:e.jsxs(j,{align:"center",children:[e.jsx(H,{}),e.jsx("span",{children:s("Learn more")})]}),children:e.jsx(q,{icon:e.jsx(H,{}),href:"https://supportgenix.com",target:"_blank"})}),e.jsx(G,{title:e.jsxs(j,{align:"center",children:[e.jsx(K,{}),e.jsx("span",{children:s("Documentation")})]}),children:e.jsx(q,{icon:e.jsx(K,{}),href:"https://supportgenix.com/doc/",target:"_blank"})})]})})]}),e.jsx(k,{children:e.jsx(o,{span:24,children:e.jsx(le,{size:"small",styles:{header:{background:"#fafafa"},body:{padding:"20px 24px 24px 24px"}},children:e.jsx(ue,{})})})})]})})}export{ke as default};
