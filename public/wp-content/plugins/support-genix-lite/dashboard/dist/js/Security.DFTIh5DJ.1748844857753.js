import{u as $,D as J,o as U,s as X,b as Z,C as V,j as e,t as i,_ as m,f as ee,x as P,M as te}from"../main.aHgQEcd5.1748844857753.js";import{r,u as se}from"./vendor.Cii7CkpR.1748844857753.js";import"./toast.D8JcjdRp.1748844857753.js";import{j as g,s as M,b as T,C as c,A as ie,u as y,w as q,o as R,x as E,D as ae,B as A,T as W,d as z,ak as N,al as O,k as ne,S as ce}from"./antd.v1CHGtH-.1748844857753.js";function re({setIsLoading:u}){const f=["recaptcha_v3_secret_key"],G={recaptcha_v3_status:!1,recaptcha_v3_site_key:"",recaptcha_v3_secret_key:"",recaptcha_v3_display_opts:["captcha_on_login_form","captcha_on_create_tckt","captcha_on_reg_form"],recaptcha_v3_hide_badge:!1},b=$(),[o]=g.useForm(),[n,I]=r.useState(null),[d,k]=r.useState(null),[l,w]=r.useState(!0),[B,j]=r.useState(!0),[S,_]=r.useState(""),[K,C]=J(),{Text:D}=W,H=U({action:"settings_data_captcha"}),L=(t,s)=>{s=m.mapValues(s,function(a){return m.isString(a)?m.trim(a):a});for(const a of f){const p=t==null?void 0:t[a];p&&m.includes(p,"*")&&(s[a]=n[a])}k(s||{}),w(!(s!=null&&s.recaptcha_v3_status)||!1);const h=m.pick(n,m.keys(s));m.isEqual(h,s)?j(!0):n!=null&&n.recaptcha_v3_status||s!=null&&s.recaptcha_v3_status?j(!1):j(!0)},Q=async t=>{var F,v;const s=t!=null&&t.recaptcha_v3_status?"A":"I",h=((F=t==null?void 0:t.recaptcha_v3_site_key)==null?void 0:F.trim())||"",a=((v=t==null?void 0:t.recaptcha_v3_secret_key)==null?void 0:v.trim())||"",p=(t==null?void 0:t.recaptcha_v3_display_opts)||[],x=t!=null&&t.recaptcha_v3_hide_badge?"Y":"N";K({params:{action:"settings_captcha"},data:{recaptcha_v3_status:s,recaptcha_v3_site_key:h,recaptcha_v3_secret_key:a,recaptcha_v3_display_opts:p,recaptcha_v3_hide_badge:x}})},Y=()=>{o.setFieldsValue(n||{}),L(null,n)};return r.useEffect(()=>{o.setFieldsValue(n||{}),k(n||{}),w(!(n!=null&&n.recaptcha_v3_status)||!1),j(!0)},[n,o]),r.useEffect(()=>{var p,x;const{data:t,isFetching:s,isError:h,error:a}=H;u(s),!s&&h&&M.error((x=(p=a==null?void 0:a.data)==null?void 0:p.errors)==null?void 0:x.message),!s&&!h&&t&&I((t==null?void 0:t.data)||{})},[H,u]),r.useEffect(()=>{var p,x,F,v;const{data:t,isLoading:s,isError:h,error:a}=C;b(s?X():Z()),!s&&h&&((x=(p=a==null?void 0:a.data)==null?void 0:p.errors)!=null&&x.message)&&M.error((v=(F=a==null?void 0:a.data)==null?void 0:F.errors)==null?void 0:v.message),!s&&!h&&t&&t!=null&&t.msg&&(t!=null&&t.status?(_(""),M.success(t==null?void 0:t.msg)):(_(t==null?void 0:t.msg),V()))},[C,b]),e.jsx(g,{form:o,name:"saveGeneralCaptcha",layout:"vertical",autoComplete:"off",onFinish:Q,onValuesChange:L,initialValues:G,children:e.jsxs(T,{children:[S?e.jsx(c,{span:24,children:e.jsx(ie,{message:S,type:"error",showIcon:!0,closable:!0,afterClose:()=>_(""),style:{marginBottom:"24px"}})}):null,e.jsx(c,{span:24,children:e.jsxs(y,{align:"center",style:{marginBottom:"24px"},children:[e.jsx(g.Item,{name:"recaptcha_v3_status",valuePropName:"checked",style:{marginBottom:0},children:e.jsx(q,{})}),e.jsx(D,{onClick:()=>{o.setFieldValue("recaptcha_v3_status",!(d!=null&&d.recaptcha_v3_status)),L(null,o.getFieldsValue())},style:{cursor:"pointer"},children:d!=null&&d.recaptcha_v3_status?i("Click to disable."):i("Click to enable and setup.")})]})}),e.jsx(c,{span:24,children:e.jsx(g.Item,{label:i("Site Key"),name:"recaptcha_v3_site_key",rules:[{required:!0,message:i("%s is required.",i("Site key")),whitespace:!0}],help:l?"":void 0,children:e.jsx(R,{disabled:l})})}),e.jsx(c,{span:24,children:e.jsx(g.Item,{label:i("Secret Key"),name:"recaptcha_v3_secret_key",rules:[{required:!0,message:i("%s is required.",i("Secret key")),whitespace:!0}],help:l?"":void 0,tooltip:i("Value containing any asterisk (*) will not be updated."),children:e.jsx(R,{disabled:l})})}),e.jsx(c,{span:24,children:e.jsx(g.Item,{label:i("Display Options"),name:"recaptcha_v3_display_opts",htmlFor:null,children:e.jsx(E.Group,{disabled:l,children:e.jsxs(T,{children:[e.jsx(c,{span:24,children:e.jsx(E,{value:"captcha_on_login_form",style:{lineHeight:"32px"},children:i("Show in Login Form")})}),e.jsx(c,{span:24,children:e.jsx(E,{value:"captcha_on_create_tckt",style:{lineHeight:"32px"},children:i("Show in Ticket Form (If not logged in)")})}),e.jsx(c,{span:24,children:e.jsx(E,{value:"captcha_on_reg_form",style:{lineHeight:"32px"},children:i("Show in Registration Form")})})]})})})}),e.jsx(ae,{style:{margin:"0 0 24px 0"}}),e.jsx(c,{span:24,children:e.jsxs(y,{align:"center",style:{marginBottom:"24px"},children:[e.jsx(g.Item,{name:"recaptcha_v3_hide_badge",valuePropName:"checked",style:{marginBottom:0},children:e.jsx(q,{size:"small",disabled:l})}),e.jsx(D,{onClick:()=>{l||(o.setFieldValue("recaptcha_v3_hide_badge",!(d!=null&&d.recaptcha_v3_hide_badge)),L(null,o.getFieldsValue()))},style:{cursor:l?"not-allowed":"pointer"},disabled:l,children:i("Hide reCAPTCHA Badge.")})]})}),e.jsx(c,{span:24,children:e.jsxs(y,{children:[e.jsx(A,{type:"primary",htmlType:"submit",loading:!1,disabled:B,children:i("Save Changes")}),e.jsx(A,{htmlType:"button",onClick:Y,disabled:B,children:i("Discard")})]})})]})})}const{Title:oe}=W;function _e(){var S;const u=ee(),f=se(),[G,b]=r.useState(!0),[o,n]=r.useState(!0),[I,d]=r.useState(""),k=(S=P(f,"settings/security",["main"]))==null?void 0:S[0];function l(){const _=I||k||"",K={main:e.jsx(re,{setIsLoading:n})};return e.jsx(e.Fragment,{children:Object.entries(K).map(([C,D])=>e.jsx("div",{className:C===_?"":"sg-hidden",children:D},C))})}r.useEffect(()=>{o||b(!1)},[o]),r.useEffect(()=>{var _;d((_=P(f,"settings/security",["main"]))==null?void 0:_[0])},[f]);const w=[{key:"main",label:e.jsx(te,{to:"/settings/security",style:{color:"inherit"},children:i("reCAPTCHA (v3)")})}],B=()=>i("reCAPTCHA (v3)"),j=u.lg||u.xl||u.xxl?{tabList:w,activeTabKey:I,defaultActiveKey:k,tabProps:{size:"middle"}}:{title:B()};return e.jsx(T,{justify:"space-around",children:e.jsxs(c,{span:24,style:{maxWidth:"960px"},children:[e.jsxs(T,{gutter:16,justify:"space-between",align:"middle",style:{paddingBottom:"8px",marginBottom:"8px"},children:[e.jsx(c,{style:{paddingBottom:"8px"},children:e.jsx(oe,{level:5,style:{fontSize:"18px",margin:0},children:i("Security")})}),e.jsx(c,{style:{paddingBottom:"8px"},children:e.jsxs(y,{children:[e.jsx(z,{title:e.jsxs(y,{align:"center",children:[e.jsx(N,{}),e.jsx("span",{children:i("Learn more")})]}),children:e.jsx(A,{icon:e.jsx(N,{}),href:"https://supportgenix.com",target:"_blank"})}),e.jsx(z,{title:e.jsxs(y,{align:"center",children:[e.jsx(O,{}),e.jsx("span",{children:i("Documentation")})]}),children:e.jsx(A,{icon:e.jsx(O,{}),href:"https://supportgenix.com/docs/",target:"_blank"})})]})})]}),e.jsx(T,{children:e.jsx(c,{span:24,children:e.jsx(ne,{size:"small",...j,styles:{header:{background:"#fafafa",fontWeight:500},body:{padding:"20px 24px 24px 24px"}},children:e.jsx(ce,{spinning:G,style:{maxHeight:"unset"},children:l()})})})})]})})}export{_e as default};
